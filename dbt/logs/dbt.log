

============================== 2022-10-28 16:20:52.619964 | becc8f7c-7db6-4a17-ac0d-24b2f4bfc570 ==============================
[0m16:20:52.619973 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:20:52.620292 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m16:20:52.620434 [debug] [MainThread]: Tracking: tracking
[0m16:20:52.621527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20abedc00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20abef2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20abef010>]}
[0m16:20:52.677223 [debug] [MainThread]: Executing "git --help"
[0m16:20:52.721775 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:20:52.722057 [debug] [MainThread]: STDERR: "b''"
[0m16:20:52.778398 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m16:20:52.778649 [debug] [MainThread]: Using postgres connection "debug"
[0m16:20:52.778788 [debug] [MainThread]: On debug: select 1 as id
[0m16:20:52.778907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:52.789531 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m16:20:52.790456 [debug] [MainThread]: On debug: Close
[0m16:20:52.790804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20aaea080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20aae9360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20aaea560>]}
[0m16:20:52.791066 [debug] [MainThread]: Flushing usage events
[0m16:20:53.162911 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-28 17:29:20.106368 | 2e7fbcb9-2534-4640-871f-e16b6e826037 ==============================
[0m17:29:20.106379 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:29:20.106737 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m17:29:20.106887 [debug] [MainThread]: Tracking: tracking
[0m17:29:20.107924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd10e8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd10e8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd10ebc40>]}
[0m17:29:20.117808 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m17:29:20.118140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e7fbcb9-2534-4640-871f-e16b6e826037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd10ea740>]}
[0m17:29:20.129206 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:29:20.149723 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:29:20.151653 [debug] [MainThread]: Parsing macros/relations.sql
[0m17:29:20.152843 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m17:29:20.154427 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m17:29:20.155788 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m17:29:20.156668 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:29:20.157551 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:29:20.158097 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:29:20.159142 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:29:20.159578 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:29:20.160810 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:29:20.166690 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m17:29:20.169871 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m17:29:20.171774 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m17:29:20.173273 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m17:29:20.174689 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m17:29:20.178355 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m17:29:20.192962 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m17:29:20.198388 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m17:29:20.211204 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m17:29:20.221584 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m17:29:20.222946 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m17:29:20.232214 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m17:29:20.235082 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m17:29:20.239368 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m17:29:20.242026 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m17:29:20.243112 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m17:29:20.247357 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m17:29:20.249239 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m17:29:20.257378 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m17:29:20.262952 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m17:29:20.276308 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m17:29:20.288404 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m17:29:20.289617 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m17:29:20.295979 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m17:29:20.297101 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m17:29:20.297827 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m17:29:20.298514 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m17:29:20.299097 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:29:20.300023 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:29:20.301027 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:29:20.301922 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m17:29:20.303175 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:29:20.304082 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:29:20.304811 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:29:20.305747 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m17:29:20.306652 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:29:20.307584 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m17:29:20.308398 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m17:29:20.309257 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:29:20.310172 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:29:20.310979 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:29:20.311910 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m17:29:20.312951 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:29:20.314633 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:29:20.315350 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:29:20.316402 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m17:29:20.317306 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:29:20.318822 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:29:20.319737 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:29:20.321619 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:29:20.322664 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m17:29:20.328270 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m17:29:20.332504 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m17:29:20.339177 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m17:29:20.341183 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m17:29:20.342466 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m17:29:20.343674 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m17:29:20.348521 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m17:29:20.354564 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:29:20.365864 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m17:29:20.367665 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m17:29:20.369283 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m17:29:20.371487 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m17:29:20.408378 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m17:29:20.420567 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m17:29:20.428401 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m17:29:20.431260 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m17:29:20.646117 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:29:20.656855 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m17:29:20.718610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e7fbcb9-2534-4640-871f-e16b6e826037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd0ae9d80>]}
[0m17:29:20.723817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e7fbcb9-2534-4640-871f-e16b6e826037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd0aa07f0>]}
[0m17:29:20.724121 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:29:20.724395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7fbcb9-2534-4640-871f-e16b6e826037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd31432e0>]}
[0m17:29:20.725443 [info ] [MainThread]: 
[0m17:29:20.725977 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:29:20.726742 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_public"
[0m17:29:20.736196 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m17:29:20.736460 [debug] [ThreadPool]: On list_template1_public: BEGIN
[0m17:29:20.736662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:20.746926 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:29:20.747177 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m17:29:20.747362 [debug] [ThreadPool]: On list_template1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_public"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:29:20.749498 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:29:20.750672 [debug] [ThreadPool]: On list_template1_public: ROLLBACK
[0m17:29:20.751059 [debug] [ThreadPool]: On list_template1_public: Close
[0m17:29:20.756459 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:20.756667 [debug] [MainThread]: On master: BEGIN
[0m17:29:20.756796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:29:20.766446 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:29:20.766701 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:20.766861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:29:20.769379 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:29:20.770434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7fbcb9-2534-4640-871f-e16b6e826037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd075c040>]}
[0m17:29:20.770696 [debug] [MainThread]: On master: ROLLBACK
[0m17:29:20.770976 [debug] [MainThread]: On master: Close
[0m17:29:20.771492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:29:20.771754 [info ] [MainThread]: 
[0m17:29:20.891308 [debug] [Thread-1 (]: Began running node model.sample_1.my_first_dbt_model
[0m17:29:20.891958 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.my_first_dbt_model"
[0m17:29:20.892142 [debug] [Thread-1 (]: Began compiling node model.sample_1.my_first_dbt_model
[0m17:29:20.892343 [debug] [Thread-1 (]: Compiling model.sample_1.my_first_dbt_model
[0m17:29:20.894846 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.my_first_dbt_model"
[0m17:29:20.895185 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.895322 [debug] [Thread-1 (]: Began executing node model.sample_1.my_first_dbt_model
[0m17:29:20.895452 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.895890 [debug] [Thread-1 (]: Finished running node model.sample_1.my_first_dbt_model
[0m17:29:20.896516 [debug] [Thread-1 (]: Began running node model.sample_1.my_second_dbt_model
[0m17:29:20.897014 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.my_second_dbt_model"
[0m17:29:20.897159 [debug] [Thread-1 (]: Began compiling node model.sample_1.my_second_dbt_model
[0m17:29:20.897284 [debug] [Thread-1 (]: Compiling model.sample_1.my_second_dbt_model
[0m17:29:20.899895 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.my_second_dbt_model"
[0m17:29:20.900117 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.900247 [debug] [Thread-1 (]: Began executing node model.sample_1.my_second_dbt_model
[0m17:29:20.900398 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.900823 [debug] [Thread-1 (]: Finished running node model.sample_1.my_second_dbt_model
[0m17:29:20.901009 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:29:20.901444 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:29:20.901712 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:29:20.901853 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:29:20.912433 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:29:20.912726 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.912863 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:29:20.912999 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.913574 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:29:20.913770 [debug] [Thread-1 (]: Began running node test.sample_1.unique_my_first_dbt_model_id.16e066b321
[0m17:29:20.914365 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_my_first_dbt_model_id.16e066b321"
[0m17:29:20.914554 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_my_first_dbt_model_id.16e066b321
[0m17:29:20.914701 [debug] [Thread-1 (]: Compiling test.sample_1.unique_my_first_dbt_model_id.16e066b321
[0m17:29:20.920672 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_my_first_dbt_model_id.16e066b321"
[0m17:29:20.921036 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.921196 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_my_first_dbt_model_id.16e066b321
[0m17:29:20.921360 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.921888 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_my_first_dbt_model_id.16e066b321
[0m17:29:20.922085 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_my_second_dbt_model_id.151b76d778
[0m17:29:20.922555 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_my_second_dbt_model_id.151b76d778"
[0m17:29:20.922707 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_my_second_dbt_model_id.151b76d778
[0m17:29:20.922893 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_my_second_dbt_model_id.151b76d778
[0m17:29:20.926993 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_my_second_dbt_model_id.151b76d778"
[0m17:29:20.927312 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.927455 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_my_second_dbt_model_id.151b76d778
[0m17:29:20.927597 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.928076 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_my_second_dbt_model_id.151b76d778
[0m17:29:20.928262 [debug] [Thread-1 (]: Began running node test.sample_1.unique_my_second_dbt_model_id.57a0f8c493
[0m17:29:20.928747 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:29:20.928887 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_my_second_dbt_model_id.57a0f8c493
[0m17:29:20.929025 [debug] [Thread-1 (]: Compiling test.sample_1.unique_my_second_dbt_model_id.57a0f8c493
[0m17:29:20.932710 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:29:20.933054 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.933200 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_my_second_dbt_model_id.57a0f8c493
[0m17:29:20.933344 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:20.933826 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_my_second_dbt_model_id.57a0f8c493
[0m17:29:20.934584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:20.934734 [debug] [MainThread]: Connection 'test.sample_1.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:29:20.940005 [info ] [MainThread]: Done.
[0m17:29:20.940391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd0741d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd0743910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd0740400>]}
[0m17:29:20.940636 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 17:29:24.851802 | 04e9bb84-277a-407a-a0ea-64010b5a9017 ==============================
[0m17:29:24.851813 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:29:24.852244 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:29:24.852484 [debug] [MainThread]: Tracking: tracking
[0m17:29:24.853546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00dbed8040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00dbed8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00dbed8df0>]}
[0m17:29:24.893420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:29:24.893632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:29:24.898874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04e9bb84-277a-407a-a0ea-64010b5a9017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00db5840d0>]}
[0m17:29:24.904803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04e9bb84-277a-407a-a0ea-64010b5a9017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00db55c8e0>]}
[0m17:29:24.905149 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:29:24.905427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04e9bb84-277a-407a-a0ea-64010b5a9017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00db522470>]}
[0m17:29:24.906444 [info ] [MainThread]: 
[0m17:29:24.906979 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:29:24.907798 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1"
[0m17:29:24.950936 [debug] [ThreadPool]: Using postgres connection "list_template1"
[0m17:29:24.951153 [debug] [ThreadPool]: On list_template1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1"} */

    select distinct nspname from pg_namespace
  
[0m17:29:24.951308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:24.961725 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m17:29:24.962998 [debug] [ThreadPool]: On list_template1: Close
[0m17:29:24.964490 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_public"
[0m17:29:24.969851 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m17:29:24.970018 [debug] [ThreadPool]: On list_template1_public: BEGIN
[0m17:29:24.970153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:24.978955 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:29:24.979158 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m17:29:24.979297 [debug] [ThreadPool]: On list_template1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_public"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:29:24.981285 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:29:24.982290 [debug] [ThreadPool]: On list_template1_public: ROLLBACK
[0m17:29:24.982574 [debug] [ThreadPool]: On list_template1_public: Close
[0m17:29:24.986889 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:24.987073 [debug] [MainThread]: On master: BEGIN
[0m17:29:24.987228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:29:24.995952 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:29:24.996167 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:24.996294 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:29:24.998513 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:29:24.999462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04e9bb84-277a-407a-a0ea-64010b5a9017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00db55c220>]}
[0m17:29:24.999725 [debug] [MainThread]: On master: ROLLBACK
[0m17:29:24.999945 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:25.000072 [debug] [MainThread]: On master: BEGIN
[0m17:29:25.000329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:29:25.000472 [debug] [MainThread]: On master: COMMIT
[0m17:29:25.000602 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:25.000725 [debug] [MainThread]: On master: COMMIT
[0m17:29:25.000956 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:29:25.001124 [debug] [MainThread]: On master: Close
[0m17:29:25.001631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:29:25.001897 [info ] [MainThread]: 
[0m17:29:25.004355 [debug] [Thread-1 (]: Began running node model.sample_1.my_first_dbt_model
[0m17:29:25.004627 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m17:29:25.005147 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.my_first_dbt_model"
[0m17:29:25.005290 [debug] [Thread-1 (]: Began compiling node model.sample_1.my_first_dbt_model
[0m17:29:25.005511 [debug] [Thread-1 (]: Compiling model.sample_1.my_first_dbt_model
[0m17:29:25.007813 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.my_first_dbt_model"
[0m17:29:25.008099 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:25.008247 [debug] [Thread-1 (]: Began executing node model.sample_1.my_first_dbt_model
[0m17:29:25.042000 [debug] [Thread-1 (]: Writing runtime sql for node "model.sample_1.my_first_dbt_model"
[0m17:29:25.042538 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_first_dbt_model"
[0m17:29:25.042682 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: BEGIN
[0m17:29:25.042806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:25.051294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:29:25.051507 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_first_dbt_model"
[0m17:29:25.051631 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_first_dbt_model"} */

  
    

  create  table "template1"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:29:25.053110 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m17:29:25.059280 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_first_dbt_model"
[0m17:29:25.059448 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_first_dbt_model"} */
alter table "template1"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:29:25.059894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:29:25.077120 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: COMMIT
[0m17:29:25.077352 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_first_dbt_model"
[0m17:29:25.077493 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: COMMIT
[0m17:29:25.187435 [debug] [Thread-1 (]: SQL status: COMMIT in 0.11 seconds
[0m17:29:25.192341 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_first_dbt_model"
[0m17:29:25.192487 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_first_dbt_model"} */
drop table if exists "template1"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:29:25.192876 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:29:25.193830 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:25.193984 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: Close
[0m17:29:25.194545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04e9bb84-277a-407a-a0ea-64010b5a9017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00db5d8190>]}
[0m17:29:25.194885 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.19s]
[0m17:29:25.195321 [debug] [Thread-1 (]: Finished running node model.sample_1.my_first_dbt_model
[0m17:29:25.196509 [debug] [Thread-1 (]: Began running node model.sample_1.my_second_dbt_model
[0m17:29:25.197132 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m17:29:25.198613 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.my_second_dbt_model"
[0m17:29:25.199054 [debug] [Thread-1 (]: Began compiling node model.sample_1.my_second_dbt_model
[0m17:29:25.199454 [debug] [Thread-1 (]: Compiling model.sample_1.my_second_dbt_model
[0m17:29:25.203040 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.my_second_dbt_model"
[0m17:29:25.203395 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:25.203575 [debug] [Thread-1 (]: Began executing node model.sample_1.my_second_dbt_model
[0m17:29:25.225862 [debug] [Thread-1 (]: Writing runtime sql for node "model.sample_1.my_second_dbt_model"
[0m17:29:25.226305 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_second_dbt_model"
[0m17:29:25.226472 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: BEGIN
[0m17:29:25.226622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:25.237606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:29:25.237873 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_second_dbt_model"
[0m17:29:25.238027 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_second_dbt_model"} */

  create view "template1"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "template1"."public"."my_first_dbt_model"
where id = 1
  );
[0m17:29:25.239506 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:29:25.242440 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_second_dbt_model"
[0m17:29:25.242618 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_second_dbt_model"} */
alter table "template1"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:29:25.243156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:29:25.244878 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: COMMIT
[0m17:29:25.245047 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_second_dbt_model"
[0m17:29:25.245192 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: COMMIT
[0m17:29:25.275675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m17:29:25.278564 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_second_dbt_model"
[0m17:29:25.278782 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_second_dbt_model"} */
drop view if exists "template1"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:29:25.279225 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:29:25.280710 [debug] [Thread-1 (]: finished collecting timing info
[0m17:29:25.280973 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: Close
[0m17:29:25.281832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04e9bb84-277a-407a-a0ea-64010b5a9017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00db88c550>]}
[0m17:29:25.282331 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m17:29:25.282943 [debug] [Thread-1 (]: Finished running node model.sample_1.my_second_dbt_model
[0m17:29:25.284474 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:29:25.284770 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:25.284985 [debug] [MainThread]: On master: BEGIN
[0m17:29:25.285182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:29:25.297731 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:29:25.298043 [debug] [MainThread]: On master: COMMIT
[0m17:29:25.298217 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:25.298380 [debug] [MainThread]: On master: COMMIT
[0m17:29:25.298689 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:29:25.298898 [debug] [MainThread]: On master: Close
[0m17:29:25.299630 [info ] [MainThread]: 
[0m17:29:25.299952 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m17:29:25.300239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:25.300424 [debug] [MainThread]: Connection 'model.sample_1.my_second_dbt_model' was properly closed.
[0m17:29:25.330047 [info ] [MainThread]: 
[0m17:29:25.330812 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:25.331158 [info ] [MainThread]: 
[0m17:29:25.331428 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:29:25.331805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00db18b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00db88d960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00db5d8f40>]}
[0m17:29:25.332099 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 17:32:19.934071 | 8ff4dee3-e5cf-466d-8efc-69ee9d8f232d ==============================
[0m17:32:19.934081 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:32:19.934520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m17:32:19.934688 [debug] [MainThread]: Tracking: tracking
[0m17:32:19.935797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac319f0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac319f0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac319f0e50>]}
[0m17:32:19.976426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:32:19.976873 [debug] [MainThread]: Partial parsing: updated file: sample_1://models/example/my_first_dbt_model.sql
[0m17:32:19.992108 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:32:20.071952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ff4dee3-e5cf-466d-8efc-69ee9d8f232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac30933eb0>]}
[0m17:32:20.078288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ff4dee3-e5cf-466d-8efc-69ee9d8f232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac30d92f50>]}
[0m17:32:20.078626 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:32:20.078898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff4dee3-e5cf-466d-8efc-69ee9d8f232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac33aa7820>]}
[0m17:32:20.079962 [info ] [MainThread]: 
[0m17:32:20.080515 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:32:20.081277 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_public"
[0m17:32:20.090857 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m17:32:20.091062 [debug] [ThreadPool]: On list_template1_public: BEGIN
[0m17:32:20.091254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:20.101622 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:32:20.101864 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m17:32:20.102021 [debug] [ThreadPool]: On list_template1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_public"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:32:20.104007 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:32:20.105445 [debug] [ThreadPool]: On list_template1_public: ROLLBACK
[0m17:32:20.105915 [debug] [ThreadPool]: On list_template1_public: Close
[0m17:32:20.111325 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:20.111629 [debug] [MainThread]: On master: BEGIN
[0m17:32:20.111761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:20.120815 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:32:20.121060 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:20.121184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:32:20.126967 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m17:32:20.128069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff4dee3-e5cf-466d-8efc-69ee9d8f232d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac30da35e0>]}
[0m17:32:20.128326 [debug] [MainThread]: On master: ROLLBACK
[0m17:32:20.128679 [debug] [MainThread]: On master: Close
[0m17:32:20.129204 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:20.129490 [info ] [MainThread]: 
[0m17:32:20.132048 [debug] [Thread-1 (]: Began running node model.sample_1.my_first_dbt_model
[0m17:32:20.132542 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.my_first_dbt_model"
[0m17:32:20.132687 [debug] [Thread-1 (]: Began compiling node model.sample_1.my_first_dbt_model
[0m17:32:20.132817 [debug] [Thread-1 (]: Compiling model.sample_1.my_first_dbt_model
[0m17:32:20.135338 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.my_first_dbt_model"
[0m17:32:20.135713 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.135868 [debug] [Thread-1 (]: Began executing node model.sample_1.my_first_dbt_model
[0m17:32:20.136074 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.136650 [debug] [Thread-1 (]: Finished running node model.sample_1.my_first_dbt_model
[0m17:32:20.139786 [debug] [Thread-1 (]: Began running node model.sample_1.my_second_dbt_model
[0m17:32:20.140605 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.my_second_dbt_model"
[0m17:32:20.141139 [debug] [Thread-1 (]: Began compiling node model.sample_1.my_second_dbt_model
[0m17:32:20.141327 [debug] [Thread-1 (]: Compiling model.sample_1.my_second_dbt_model
[0m17:32:20.144396 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.my_second_dbt_model"
[0m17:32:20.144780 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.144919 [debug] [Thread-1 (]: Began executing node model.sample_1.my_second_dbt_model
[0m17:32:20.145044 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.145543 [debug] [Thread-1 (]: Finished running node model.sample_1.my_second_dbt_model
[0m17:32:20.145719 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:32:20.146260 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:32:20.146539 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:32:20.146691 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:32:20.157349 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:32:20.157650 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.157809 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:32:20.157948 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.158409 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:32:20.158595 [debug] [Thread-1 (]: Began running node test.sample_1.unique_my_first_dbt_model_id.16e066b321
[0m17:32:20.159055 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_my_first_dbt_model_id.16e066b321"
[0m17:32:20.159189 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_my_first_dbt_model_id.16e066b321
[0m17:32:20.159319 [debug] [Thread-1 (]: Compiling test.sample_1.unique_my_first_dbt_model_id.16e066b321
[0m17:32:20.165255 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_my_first_dbt_model_id.16e066b321"
[0m17:32:20.165633 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.165790 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_my_first_dbt_model_id.16e066b321
[0m17:32:20.165946 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.166439 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_my_first_dbt_model_id.16e066b321
[0m17:32:20.166641 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_my_second_dbt_model_id.151b76d778
[0m17:32:20.167152 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_my_second_dbt_model_id.151b76d778"
[0m17:32:20.167341 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_my_second_dbt_model_id.151b76d778
[0m17:32:20.167469 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_my_second_dbt_model_id.151b76d778
[0m17:32:20.172725 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_my_second_dbt_model_id.151b76d778"
[0m17:32:20.173089 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.173248 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_my_second_dbt_model_id.151b76d778
[0m17:32:20.173394 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.173866 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_my_second_dbt_model_id.151b76d778
[0m17:32:20.174101 [debug] [Thread-1 (]: Began running node test.sample_1.unique_my_second_dbt_model_id.57a0f8c493
[0m17:32:20.174552 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:32:20.174690 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_my_second_dbt_model_id.57a0f8c493
[0m17:32:20.174828 [debug] [Thread-1 (]: Compiling test.sample_1.unique_my_second_dbt_model_id.57a0f8c493
[0m17:32:20.178447 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:32:20.178824 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.178973 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_my_second_dbt_model_id.57a0f8c493
[0m17:32:20.179122 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:20.179611 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_my_second_dbt_model_id.57a0f8c493
[0m17:32:20.180452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:20.180603 [debug] [MainThread]: Connection 'test.sample_1.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:32:20.206027 [info ] [MainThread]: Done.
[0m17:32:20.206396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac309c02b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac309c0130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac309c0a00>]}
[0m17:32:20.206618 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 17:32:24.004746 | b5328a22-9d30-46d6-bbac-2feff30bf042 ==============================
[0m17:32:24.004757 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:32:24.005160 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:32:24.005332 [debug] [MainThread]: Tracking: tracking
[0m17:32:24.006339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dfcd8040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dfcd8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dfcd8df0>]}
[0m17:32:24.045548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:24.045758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:24.050986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5328a22-9d30-46d6-bbac-2feff30bf042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41df3800d0>]}
[0m17:32:24.056800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5328a22-9d30-46d6-bbac-2feff30bf042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41df358a90>]}
[0m17:32:24.057146 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:32:24.057375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5328a22-9d30-46d6-bbac-2feff30bf042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41df322470>]}
[0m17:32:24.058353 [info ] [MainThread]: 
[0m17:32:24.058953 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:32:24.059800 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1"
[0m17:32:24.107822 [debug] [ThreadPool]: Using postgres connection "list_template1"
[0m17:32:24.108057 [debug] [ThreadPool]: On list_template1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1"} */

    select distinct nspname from pg_namespace
  
[0m17:32:24.108188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:24.118610 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m17:32:24.119821 [debug] [ThreadPool]: On list_template1: Close
[0m17:32:24.121312 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_public"
[0m17:32:24.126440 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m17:32:24.126593 [debug] [ThreadPool]: On list_template1_public: BEGIN
[0m17:32:24.126720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:32:24.135300 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m17:32:24.135516 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m17:32:24.135662 [debug] [ThreadPool]: On list_template1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_public"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:32:24.137592 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:32:24.138705 [debug] [ThreadPool]: On list_template1_public: ROLLBACK
[0m17:32:24.138978 [debug] [ThreadPool]: On list_template1_public: Close
[0m17:32:24.143167 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:24.143368 [debug] [MainThread]: On master: BEGIN
[0m17:32:24.143517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:24.152172 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:32:24.152400 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:24.152527 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:32:24.158033 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m17:32:24.159147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5328a22-9d30-46d6-bbac-2feff30bf042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41df358220>]}
[0m17:32:24.159412 [debug] [MainThread]: On master: ROLLBACK
[0m17:32:24.159666 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:24.159783 [debug] [MainThread]: On master: BEGIN
[0m17:32:24.160143 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:32:24.160282 [debug] [MainThread]: On master: COMMIT
[0m17:32:24.160432 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:24.160552 [debug] [MainThread]: On master: COMMIT
[0m17:32:24.160839 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:32:24.160977 [debug] [MainThread]: On master: Close
[0m17:32:24.161499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:24.161734 [info ] [MainThread]: 
[0m17:32:24.164044 [debug] [Thread-1 (]: Began running node model.sample_1.my_first_dbt_model
[0m17:32:24.164339 [info ] [Thread-1 (]: 1 of 2 START sql view model public.my_first_dbt_model .......................... [RUN]
[0m17:32:24.164946 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.my_first_dbt_model"
[0m17:32:24.165093 [debug] [Thread-1 (]: Began compiling node model.sample_1.my_first_dbt_model
[0m17:32:24.165249 [debug] [Thread-1 (]: Compiling model.sample_1.my_first_dbt_model
[0m17:32:24.167609 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.my_first_dbt_model"
[0m17:32:24.167918 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:24.168082 [debug] [Thread-1 (]: Began executing node model.sample_1.my_first_dbt_model
[0m17:32:24.201569 [debug] [Thread-1 (]: Writing runtime sql for node "model.sample_1.my_first_dbt_model"
[0m17:32:24.202007 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_first_dbt_model"
[0m17:32:24.202153 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: BEGIN
[0m17:32:24.202284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:24.211275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:32:24.211498 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_first_dbt_model"
[0m17:32:24.211623 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_first_dbt_model"} */

  create view "template1"."public"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:32:24.212859 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:32:24.218182 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_first_dbt_model"
[0m17:32:24.218334 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_first_dbt_model"} */
alter table "template1"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:32:24.219673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:32:24.221780 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_first_dbt_model"
[0m17:32:24.221915 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_first_dbt_model"} */
alter table "template1"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:32:24.222342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:32:24.238280 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: COMMIT
[0m17:32:24.238492 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_first_dbt_model"
[0m17:32:24.238653 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: COMMIT
[0m17:32:24.297245 [debug] [Thread-1 (]: SQL status: COMMIT in 0.06 seconds
[0m17:32:24.303470 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_first_dbt_model"
[0m17:32:24.303611 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_first_dbt_model"} */
drop table if exists "template1"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:32:24.387010 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.08 seconds
[0m17:32:24.389335 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:24.389538 [debug] [Thread-1 (]: On model.sample_1.my_first_dbt_model: Close
[0m17:32:24.390201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5328a22-9d30-46d6-bbac-2feff30bf042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41df36fd30>]}
[0m17:32:24.390587 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.my_first_dbt_model ..................... [[32mCREATE VIEW[0m in 0.23s]
[0m17:32:24.391046 [debug] [Thread-1 (]: Finished running node model.sample_1.my_first_dbt_model
[0m17:32:24.391631 [debug] [Thread-1 (]: Began running node model.sample_1.my_second_dbt_model
[0m17:32:24.391976 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m17:32:24.392619 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.my_second_dbt_model"
[0m17:32:24.392796 [debug] [Thread-1 (]: Began compiling node model.sample_1.my_second_dbt_model
[0m17:32:24.392957 [debug] [Thread-1 (]: Compiling model.sample_1.my_second_dbt_model
[0m17:32:24.396016 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.my_second_dbt_model"
[0m17:32:24.396475 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:24.396664 [debug] [Thread-1 (]: Began executing node model.sample_1.my_second_dbt_model
[0m17:32:24.401510 [debug] [Thread-1 (]: Writing runtime sql for node "model.sample_1.my_second_dbt_model"
[0m17:32:24.402309 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_second_dbt_model"
[0m17:32:24.402537 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: BEGIN
[0m17:32:24.402686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:24.413387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m17:32:24.413652 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_second_dbt_model"
[0m17:32:24.413827 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_second_dbt_model"} */

  create view "template1"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "template1"."public"."my_first_dbt_model"
where id = 1
  );
[0m17:32:24.415187 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:32:24.417688 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_second_dbt_model"
[0m17:32:24.417970 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_second_dbt_model"} */
alter table "template1"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:32:24.418708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:32:24.420647 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: COMMIT
[0m17:32:24.420878 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_second_dbt_model"
[0m17:32:24.421025 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: COMMIT
[0m17:32:24.455674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m17:32:24.458213 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.my_second_dbt_model"
[0m17:32:24.458389 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.my_second_dbt_model"} */
drop view if exists "template1"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:32:24.458760 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:32:24.460034 [debug] [Thread-1 (]: finished collecting timing info
[0m17:32:24.460231 [debug] [Thread-1 (]: On model.sample_1.my_second_dbt_model: Close
[0m17:32:24.460899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5328a22-9d30-46d6-bbac-2feff30bf042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41df372f20>]}
[0m17:32:24.461281 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.07s]
[0m17:32:24.461731 [debug] [Thread-1 (]: Finished running node model.sample_1.my_second_dbt_model
[0m17:32:24.462858 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:32:24.463078 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:24.463235 [debug] [MainThread]: On master: BEGIN
[0m17:32:24.463380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:32:24.474470 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m17:32:24.474769 [debug] [MainThread]: On master: COMMIT
[0m17:32:24.474938 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:24.475088 [debug] [MainThread]: On master: COMMIT
[0m17:32:24.475371 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:32:24.475560 [debug] [MainThread]: On master: Close
[0m17:32:24.476269 [info ] [MainThread]: 
[0m17:32:24.476597 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m17:32:24.476848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:24.476984 [debug] [MainThread]: Connection 'model.sample_1.my_second_dbt_model' was properly closed.
[0m17:32:24.521355 [info ] [MainThread]: 
[0m17:32:24.521772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:24.522090 [info ] [MainThread]: 
[0m17:32:24.522326 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:32:24.522652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dfdecdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41dfded0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41def4d390>]}
[0m17:32:24.522909 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:06:54.143056 | 2e1a85f0-5ee7-419e-a212-c0da76a8a69f ==============================
[0m18:06:54.143068 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:06:54.143473 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m18:06:54.143635 [debug] [MainThread]: Tracking: tracking
[0m18:06:54.144763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2454fde590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2454fdeef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2454fdebf0>]}
[0m18:06:54.145026 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:06:54.145301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2454fdeef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2454fdec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2454fdf070>]}
[0m18:06:54.145497 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:07:02.800146 | f52d941c-4e4f-470f-b17f-0006732fab24 ==============================
[0m18:07:02.800158 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:07:02.800517 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:07:02.800676 [debug] [MainThread]: Tracking: tracking
[0m18:07:02.801787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed343e0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed343e0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed343e0df0>]}
[0m18:07:02.841021 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 1 files changed.
[0m18:07:02.841415 [debug] [MainThread]: Partial parsing: added file: sample_1://seeds/tmdb_5000_movies.csv
[0m18:07:02.841640 [debug] [MainThread]: Partial parsing: added file: sample_1://models/example/tmdb_credits.sql
[0m18:07:02.841841 [debug] [MainThread]: Partial parsing: added file: sample_1://seeds/tmdb_5000_credits.csv
[0m18:07:02.842126 [debug] [MainThread]: Partial parsing: update schema file: sample_1://models/example/schema.yml
[0m18:07:02.842267 [debug] [MainThread]: Partial parsing: deleted file: sample_1://models/example/my_first_dbt_model.sql
[0m18:07:02.842401 [debug] [MainThread]: Partial parsing: deleted file: sample_1://models/example/my_second_dbt_model.sql
[0m18:07:02.858135 [debug] [MainThread]: 1699: static parser successfully parsed example/tmdb_credits.sql
[0m18:07:02.969262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f52d941c-4e4f-470f-b17f-0006732fab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed337b2050>]}
[0m18:07:02.975085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f52d941c-4e4f-470f-b17f-0006732fab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3373e8c0>]}
[0m18:07:02.975416 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:07:02.975660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f52d941c-4e4f-470f-b17f-0006732fab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed36473820>]}
[0m18:07:02.976691 [info ] [MainThread]: 
[0m18:07:02.977219 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:07:02.978072 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_public"
[0m18:07:02.987529 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:07:02.987705 [debug] [ThreadPool]: On list_template1_public: BEGIN
[0m18:07:02.987848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:02.997987 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:07:02.998255 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:07:02.998422 [debug] [ThreadPool]: On list_template1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_public"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:07:03.000471 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:07:03.001773 [debug] [ThreadPool]: On list_template1_public: ROLLBACK
[0m18:07:03.002086 [debug] [ThreadPool]: On list_template1_public: Close
[0m18:07:03.010921 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:03.011203 [debug] [MainThread]: On master: BEGIN
[0m18:07:03.011419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:03.020352 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:07:03.020587 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:03.020738 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:07:03.026730 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:07:03.027876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f52d941c-4e4f-470f-b17f-0006732fab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed337b2560>]}
[0m18:07:03.028147 [debug] [MainThread]: On master: ROLLBACK
[0m18:07:03.028440 [debug] [MainThread]: On master: Close
[0m18:07:03.029043 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:03.029309 [info ] [MainThread]: 
[0m18:07:03.032193 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:07:03.032661 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:07:03.032811 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:07:03.032972 [debug] [Thread-1 (]: Compiling seed.sample_1.tmdb_5000_credits
[0m18:07:03.035237 [debug] [Thread-1 (]: Writing injected SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:07:03.035641 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.035998 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:07:03.036385 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.037248 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:07:03.037516 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_movies
[0m18:07:03.039683 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_movies"
[0m18:07:03.040115 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_movies
[0m18:07:03.040343 [debug] [Thread-1 (]: Compiling seed.sample_1.tmdb_5000_movies
[0m18:07:03.042164 [debug] [Thread-1 (]: Writing injected SQL for node "seed.sample_1.tmdb_5000_movies"
[0m18:07:03.042351 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.042493 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_movies
[0m18:07:03.042631 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.043151 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_movies
[0m18:07:03.043323 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:07:03.043764 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:07:03.043899 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:07:03.044031 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:07:03.046726 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:07:03.047065 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.047207 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:07:03.047360 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.047933 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:07:03.048670 [debug] [Thread-1 (]: Began running node test.sample_1.is_not_empty_string_tmdb_credits_title.f4ae1e801e
[0m18:07:03.049085 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.is_not_empty_string_tmdb_credits_title.f4ae1e801e"
[0m18:07:03.049307 [debug] [Thread-1 (]: Began compiling node test.sample_1.is_not_empty_string_tmdb_credits_title.f4ae1e801e
[0m18:07:03.049462 [debug] [Thread-1 (]: Compiling test.sample_1.is_not_empty_string_tmdb_credits_title.f4ae1e801e
[0m18:07:03.094414 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.095002 [debug] [Thread-1 (]: Compilation Error in test is_not_empty_string_tmdb_credits_title (models/example/schema.yml)
  'test_is_not_empty_string' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:07:03.095277 [debug] [Thread-1 (]: Finished running node test.sample_1.is_not_empty_string_tmdb_credits_title.f4ae1e801e
[0m18:07:03.095505 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:03.096199 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:07:03.096329 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:03.096470 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:03.104092 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:07:03.104401 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.104558 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:03.104700 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.105155 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:03.105358 [debug] [Thread-1 (]: Began running node test.sample_1.note_null_tmdb_credits_title.0c6d19a109
[0m18:07:03.105827 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.note_null_tmdb_credits_title.0c6d19a109"
[0m18:07:03.105967 [debug] [Thread-1 (]: Began compiling node test.sample_1.note_null_tmdb_credits_title.0c6d19a109
[0m18:07:03.106112 [debug] [Thread-1 (]: Compiling test.sample_1.note_null_tmdb_credits_title.0c6d19a109
[0m18:07:03.109137 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.109569 [debug] [Thread-1 (]: Compilation Error in test note_null_tmdb_credits_title (models/example/schema.yml)
  'test_note_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:07:03.109796 [debug] [Thread-1 (]: Finished running node test.sample_1.note_null_tmdb_credits_title.0c6d19a109
[0m18:07:03.110007 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:03.110485 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:07:03.110610 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:03.110742 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:03.116319 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:07:03.116661 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.116800 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:03.116928 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:03.117438 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:03.117910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:03.118048 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m18:07:03.118262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed333ba140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3374bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed337b3850>]}
[0m18:07:03.118478 [debug] [MainThread]: Flushing usage events
[0m18:07:03.499492 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test note_null_tmdb_credits_title (models/example/schema.yml)
    'test_note_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".


============================== 2022-10-28 18:07:35.840581 | 94e910c4-bf11-47f0-bfc7-7448034bd9c9 ==============================
[0m18:07:35.840593 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:07:35.840959 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:07:35.841119 [debug] [MainThread]: Tracking: tracking
[0m18:07:35.842182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a18cc040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a18cce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a18ccdf0>]}
[0m18:07:35.882561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:35.883132 [debug] [MainThread]: Partial parsing: update schema file: sample_1://models/example/schema.yml
[0m18:07:35.898697 [debug] [MainThread]: 1699: static parser successfully parsed example/tmdb_credits.sql
[0m18:07:35.995986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94e910c4-bf11-47f0-bfc7-7448034bd9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a0b35f60>]}
[0m18:07:36.002817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94e910c4-bf11-47f0-bfc7-7448034bd9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a0f8ae30>]}
[0m18:07:36.003196 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:07:36.003467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94e910c4-bf11-47f0-bfc7-7448034bd9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a3943820>]}
[0m18:07:36.004572 [info ] [MainThread]: 
[0m18:07:36.005142 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:07:36.006005 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_public"
[0m18:07:36.015647 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:07:36.015859 [debug] [ThreadPool]: On list_template1_public: BEGIN
[0m18:07:36.016065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:36.026264 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:07:36.026496 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:07:36.026643 [debug] [ThreadPool]: On list_template1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_public"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:07:36.028629 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:07:36.029893 [debug] [ThreadPool]: On list_template1_public: ROLLBACK
[0m18:07:36.030243 [debug] [ThreadPool]: On list_template1_public: Close
[0m18:07:36.038259 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:36.038511 [debug] [MainThread]: On master: BEGIN
[0m18:07:36.038661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:36.047814 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:07:36.048059 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:36.048222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:07:36.054642 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:07:36.055952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94e910c4-bf11-47f0-bfc7-7448034bd9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a0f8b430>]}
[0m18:07:36.056342 [debug] [MainThread]: On master: ROLLBACK
[0m18:07:36.056656 [debug] [MainThread]: On master: Close
[0m18:07:36.057321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:36.057678 [info ] [MainThread]: 
[0m18:07:36.060587 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:07:36.061525 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:07:36.061811 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:07:36.062019 [debug] [Thread-1 (]: Compiling seed.sample_1.tmdb_5000_credits
[0m18:07:36.064064 [debug] [Thread-1 (]: Writing injected SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:07:36.064292 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.064454 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:07:36.064598 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.065237 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:07:36.065471 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_movies
[0m18:07:36.066183 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_movies"
[0m18:07:36.066567 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_movies
[0m18:07:36.066751 [debug] [Thread-1 (]: Compiling seed.sample_1.tmdb_5000_movies
[0m18:07:36.068638 [debug] [Thread-1 (]: Writing injected SQL for node "seed.sample_1.tmdb_5000_movies"
[0m18:07:36.068972 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.069218 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_movies
[0m18:07:36.069479 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.070396 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_movies
[0m18:07:36.070619 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:07:36.071200 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:07:36.071347 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:07:36.071477 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:07:36.074412 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:07:36.074728 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.074884 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:07:36.075071 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.075595 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:07:36.076450 [debug] [Thread-1 (]: Began running node test.sample_1.is_not_empty_string_tmdb_credits_title.f4ae1e801e
[0m18:07:36.076864 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.is_not_empty_string_tmdb_credits_title.f4ae1e801e"
[0m18:07:36.077006 [debug] [Thread-1 (]: Began compiling node test.sample_1.is_not_empty_string_tmdb_credits_title.f4ae1e801e
[0m18:07:36.077133 [debug] [Thread-1 (]: Compiling test.sample_1.is_not_empty_string_tmdb_credits_title.f4ae1e801e
[0m18:07:36.080943 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.081403 [debug] [Thread-1 (]: Compilation Error in test is_not_empty_string_tmdb_credits_title (models/example/schema.yml)
  'test_is_not_empty_string' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:07:36.081675 [debug] [Thread-1 (]: Finished running node test.sample_1.is_not_empty_string_tmdb_credits_title.f4ae1e801e
[0m18:07:36.081936 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:36.082465 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:07:36.082612 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:36.082779 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:36.092809 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:07:36.093185 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.093437 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:36.093578 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.094124 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:36.094324 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:07:36.094815 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:07:36.095005 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:07:36.095152 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:07:36.098850 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:07:36.099119 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.099267 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:07:36.099405 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.099885 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:07:36.100109 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:36.100591 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:07:36.100717 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:36.100874 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:36.106613 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:07:36.107037 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.107256 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:36.107415 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:36.107951 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:36.108290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:36.108568 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m18:07:36.108900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a0fb4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a0b96e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a0b7b010>]}
[0m18:07:36.109127 [debug] [MainThread]: Flushing usage events
[0m18:07:36.473926 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test is_not_empty_string_tmdb_credits_title (models/example/schema.yml)
    'test_is_not_empty_string' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".


============================== 2022-10-28 18:07:54.753005 | 676fdaa4-19b1-4b35-867a-2ba4f0ae1b96 ==============================
[0m18:07:54.753016 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:07:54.753393 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:07:54.753552 [debug] [MainThread]: Tracking: tracking
[0m18:07:54.754667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647e5d4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647e5d4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647e5d4e50>]}
[0m18:07:54.794533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:54.795019 [debug] [MainThread]: Partial parsing: update schema file: sample_1://models/example/schema.yml
[0m18:07:54.810263 [debug] [MainThread]: 1699: static parser successfully parsed example/tmdb_credits.sql
[0m18:07:54.894530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '676fdaa4-19b1-4b35-867a-2ba4f0ae1b96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647d520df0>]}
[0m18:07:54.900924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '676fdaa4-19b1-4b35-867a-2ba4f0ae1b96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647d9a86d0>]}
[0m18:07:54.901284 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:07:54.901543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676fdaa4-19b1-4b35-867a-2ba4f0ae1b96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64806df820>]}
[0m18:07:54.902580 [info ] [MainThread]: 
[0m18:07:54.903113 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:07:54.903892 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_public"
[0m18:07:54.913389 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:07:54.913588 [debug] [ThreadPool]: On list_template1_public: BEGIN
[0m18:07:54.913776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:54.923959 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:07:54.924194 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:07:54.924317 [debug] [ThreadPool]: On list_template1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_public"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:07:54.926254 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:07:54.927428 [debug] [ThreadPool]: On list_template1_public: ROLLBACK
[0m18:07:54.927680 [debug] [ThreadPool]: On list_template1_public: Close
[0m18:07:54.932801 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:54.933105 [debug] [MainThread]: On master: BEGIN
[0m18:07:54.933268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:54.942728 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:07:54.942965 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:54.943093 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:07:54.948752 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:07:54.950007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676fdaa4-19b1-4b35-867a-2ba4f0ae1b96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647d9aa5c0>]}
[0m18:07:54.950269 [debug] [MainThread]: On master: ROLLBACK
[0m18:07:54.950623 [debug] [MainThread]: On master: Close
[0m18:07:54.951173 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:54.951429 [info ] [MainThread]: 
[0m18:07:54.954148 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:07:54.954675 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:07:54.954824 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:07:54.954965 [debug] [Thread-1 (]: Compiling seed.sample_1.tmdb_5000_credits
[0m18:07:54.956555 [debug] [Thread-1 (]: Writing injected SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:07:54.956743 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.956912 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:07:54.957084 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.957673 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:07:54.957889 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_movies
[0m18:07:54.958453 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_movies"
[0m18:07:54.958899 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_movies
[0m18:07:54.959096 [debug] [Thread-1 (]: Compiling seed.sample_1.tmdb_5000_movies
[0m18:07:54.960869 [debug] [Thread-1 (]: Writing injected SQL for node "seed.sample_1.tmdb_5000_movies"
[0m18:07:54.961197 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.961405 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_movies
[0m18:07:54.961561 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.962147 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_movies
[0m18:07:54.962341 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:07:54.962798 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:07:54.962934 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:07:54.963108 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:07:54.966544 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:07:54.967016 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.967174 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:07:54.967312 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.967832 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:07:54.968470 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:54.968864 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:07:54.969002 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:54.969130 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:54.980246 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:07:54.980618 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.980773 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:54.980941 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.981477 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:07:54.981652 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:07:54.982101 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:07:54.982226 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:07:54.982370 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:07:54.985952 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:07:54.986208 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.986349 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:07:54.986490 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.986931 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:07:54.987124 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:54.987565 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:07:54.987689 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:54.987830 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:54.994597 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:07:54.995003 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.995162 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:54.995369 [debug] [Thread-1 (]: finished collecting timing info
[0m18:07:54.995993 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:07:54.996929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:54.997073 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m18:07:55.020709 [info ] [MainThread]: Done.
[0m18:07:55.021078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647fb2bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647d96ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647d57bc10>]}
[0m18:07:55.021317 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:08:21.177398 | 8c9874f4-bda4-4005-a4a8-b51cca217e6b ==============================
[0m18:08:21.177410 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:08:21.177769 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m18:08:21.177938 [debug] [MainThread]: Tracking: tracking
[0m18:08:21.178940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf0ccc070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf0cccd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf0ccfc40>]}
[0m18:08:21.220089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:21.220315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:21.225746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c9874f4-bda4-4005-a4a8-b51cca217e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf03840d0>]}
[0m18:08:21.231840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c9874f4-bda4-4005-a4a8-b51cca217e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf0351180>]}
[0m18:08:21.232209 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:08:21.232457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c9874f4-bda4-4005-a4a8-b51cca217e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf0cc4670>]}
[0m18:08:21.233596 [info ] [MainThread]: 
[0m18:08:21.234180 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:08:21.235093 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1"
[0m18:08:21.286030 [debug] [ThreadPool]: Using postgres connection "list_template1"
[0m18:08:21.286347 [debug] [ThreadPool]: On list_template1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1"} */

    select distinct nspname from pg_namespace
  
[0m18:08:21.286504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:21.297573 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m18:08:21.299573 [debug] [ThreadPool]: On list_template1: Close
[0m18:08:21.301144 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_public"
[0m18:08:21.306669 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:08:21.306836 [debug] [ThreadPool]: On list_template1_public: BEGIN
[0m18:08:21.307005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:21.315952 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:08:21.316181 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:08:21.316304 [debug] [ThreadPool]: On list_template1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_public"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:08:21.318230 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:08:21.319315 [debug] [ThreadPool]: On list_template1_public: ROLLBACK
[0m18:08:21.319595 [debug] [ThreadPool]: On list_template1_public: Close
[0m18:08:21.323726 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:21.323928 [debug] [MainThread]: On master: BEGIN
[0m18:08:21.324058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:21.332728 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:08:21.332954 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:21.333083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:08:21.338780 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:08:21.340068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c9874f4-bda4-4005-a4a8-b51cca217e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf20da290>]}
[0m18:08:21.340359 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:21.340671 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:21.340797 [debug] [MainThread]: On master: BEGIN
[0m18:08:21.341126 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:21.341250 [debug] [MainThread]: On master: COMMIT
[0m18:08:21.341428 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:21.341552 [debug] [MainThread]: On master: COMMIT
[0m18:08:21.341797 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:08:21.341954 [debug] [MainThread]: On master: Close
[0m18:08:21.342527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:21.342785 [info ] [MainThread]: 
[0m18:08:21.345165 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:08:21.345486 [info ] [Thread-1 (]: 1 of 2 START seed file public.tmdb_5000_credits ................................ [RUN]
[0m18:08:21.345988 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:08:21.346123 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:08:21.346250 [debug] [Thread-1 (]: finished collecting timing info
[0m18:08:21.346370 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:08:21.838560 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:08:21.838810 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: BEGIN
[0m18:08:21.838997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:21.847910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:08:21.848119 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:08:21.848261 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "seed.sample_1.tmdb_5000_credits"} */

    create table "template1"."public"."tmdb_5000_credits" ("movie_id" integer,"title" text,"cast" text,"crew" text)
  
[0m18:08:21.877982 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.03 seconds
[0m18:08:26.422114 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:08:26.422361 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: 
          insert into "template1"."public"."tmdb_5000_credits" ("movie_id", "title", "cast", "crew") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(...
[0m18:08:27.633200 [debug] [Thread-1 (]: SQL status: INSERT 0 4803 in 1.21 seconds
[0m18:08:27.640703 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:08:27.657048 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:08:27.657233 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:08:27.657382 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:08:27.680939 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m18:08:27.681732 [debug] [Thread-1 (]: finished collecting timing info
[0m18:08:27.681895 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: Close
[0m18:08:27.683629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9874f4-bda4-4005-a4a8-b51cca217e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf03ebb20>]}
[0m18:08:27.683946 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.tmdb_5000_credits ............................ [[32mINSERT 4803[0m in 6.34s]
[0m18:08:27.684370 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:08:27.684568 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_movies
[0m18:08:27.684934 [info ] [Thread-1 (]: 2 of 2 START seed file public.tmdb_5000_movies ................................. [RUN]
[0m18:08:27.685498 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_movies"
[0m18:08:27.685633 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_movies
[0m18:08:27.685787 [debug] [Thread-1 (]: finished collecting timing info
[0m18:08:27.685934 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_movies
[0m18:08:28.159845 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_movies"
[0m18:08:28.160098 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_movies: BEGIN
[0m18:08:28.160264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:28.169096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:08:28.169280 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_movies"
[0m18:08:28.169416 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_movies: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "seed.sample_1.tmdb_5000_movies"} */

    create table "template1"."public"."tmdb_5000_movies" ("budget" integer,"genres" text,"homepage" text,"id" integer,"keywords" text,"original_language" text,"original_title" text,"overview" text,"popularity" float8,"production_companies" text,"production_countries" text,"release_date" date,"revenue" integer,"runtime" integer,"spoken_languages" text,"status" text,"tagline" text,"title" text,"vote_average" float8,"vote_count" integer)
  
[0m18:08:28.208053 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.04 seconds
[0m18:08:50.978978 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_movies"
[0m18:08:50.979224 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_movies: 
          insert into "template1"."public"."tmdb_5000_movies" ("budget", "genres", "homepage", "id", "keywords", "original_language", "original_title", "overview", "popularity", "production_companies", "production_countries", "release_date", "revenue", "runtime", "spoken_languages", "status", "tagline", "title", "vote_average", "vote_count") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m18:08:51.174553 [debug] [Thread-1 (]: Postgres adapter: Postgres error: integer out of range

[0m18:08:51.174877 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_movies: ROLLBACK
[0m18:08:51.175350 [debug] [Thread-1 (]: finished collecting timing info
[0m18:08:51.175511 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_movies: Close
[0m18:08:51.176106 [debug] [Thread-1 (]: Database Error in seed tmdb_5000_movies (seeds/tmdb_5000_movies.csv)
  integer out of range
[0m18:08:51.177709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9874f4-bda4-4005-a4a8-b51cca217e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf03cc2b0>]}
[0m18:08:51.178098 [error] [Thread-1 (]: 2 of 2 ERROR loading seed file public.tmdb_5000_movies ......................... [[31mERROR[0m in 23.49s]
[0m18:08:51.178517 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_movies
[0m18:08:51.179583 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:08:51.179759 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:51.179886 [debug] [MainThread]: On master: BEGIN
[0m18:08:51.180003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:51.188873 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:08:51.189129 [debug] [MainThread]: On master: COMMIT
[0m18:08:51.189264 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:51.189412 [debug] [MainThread]: On master: COMMIT
[0m18:08:51.189694 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:08:51.189869 [debug] [MainThread]: On master: Close
[0m18:08:51.190662 [info ] [MainThread]: 
[0m18:08:51.191085 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 29.96 seconds (29.96s).
[0m18:08:51.191328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:51.191450 [debug] [MainThread]: Connection 'seed.sample_1.tmdb_5000_movies' was properly closed.
[0m18:08:51.198713 [info ] [MainThread]: 
[0m18:08:51.199105 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:08:51.199413 [info ] [MainThread]: 
[0m18:08:51.199619 [error] [MainThread]: [33mDatabase Error in seed tmdb_5000_movies (seeds/tmdb_5000_movies.csv)[0m
[0m18:08:51.199809 [error] [MainThread]:   integer out of range
[0m18:08:51.199999 [info ] [MainThread]: 
[0m18:08:51.200182 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:08:51.200461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf0350d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf0350280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf0cb6ad0>]}
[0m18:08:51.200716 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:09:45.043210 | 4f1947b3-d173-4e1e-83a8-009580dd2e5b ==============================
[0m18:09:45.043223 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:09:45.043634 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m18:09:45.043812 [debug] [MainThread]: Tracking: tracking
[0m18:09:45.044892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d44fd4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d44fd4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d44fd4e50>]}
[0m18:09:45.088776 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m18:09:45.089051 [debug] [MainThread]: Partial parsing: deleted file: sample_1://seeds/tmdb_5000_movies.csv
[0m18:09:45.105746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f1947b3-d173-4e1e-83a8-009580dd2e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d443a4520>]}
[0m18:09:45.143800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f1947b3-d173-4e1e-83a8-009580dd2e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d464deb30>]}
[0m18:09:45.144161 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:09:45.144448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f1947b3-d173-4e1e-83a8-009580dd2e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d47083820>]}
[0m18:09:45.145623 [info ] [MainThread]: 
[0m18:09:45.146242 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:09:45.147138 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1"
[0m18:09:45.157327 [debug] [ThreadPool]: Using postgres connection "list_template1"
[0m18:09:45.157682 [debug] [ThreadPool]: On list_template1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1"} */

    select distinct nspname from pg_namespace
  
[0m18:09:45.157925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:45.169401 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m18:09:45.170867 [debug] [ThreadPool]: On list_template1: Close
[0m18:09:45.173406 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_public"
[0m18:09:45.180946 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:09:45.181202 [debug] [ThreadPool]: On list_template1_public: BEGIN
[0m18:09:45.181408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:45.190592 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:09:45.190817 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:09:45.190973 [debug] [ThreadPool]: On list_template1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_public"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:09:45.192995 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:09:45.194266 [debug] [ThreadPool]: On list_template1_public: ROLLBACK
[0m18:09:45.194536 [debug] [ThreadPool]: On list_template1_public: Close
[0m18:09:45.199077 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:45.199267 [debug] [MainThread]: On master: BEGIN
[0m18:09:45.199412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:45.208244 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:09:45.208439 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:45.208576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:45.215219 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:09:45.216364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f1947b3-d173-4e1e-83a8-009580dd2e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d443d7e80>]}
[0m18:09:45.216643 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:45.216891 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:45.217022 [debug] [MainThread]: On master: BEGIN
[0m18:09:45.217263 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:45.217424 [debug] [MainThread]: On master: COMMIT
[0m18:09:45.217552 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:45.217676 [debug] [MainThread]: On master: COMMIT
[0m18:09:45.217907 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:09:45.218071 [debug] [MainThread]: On master: Close
[0m18:09:45.218609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:45.218896 [info ] [MainThread]: 
[0m18:09:45.221530 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:09:45.221793 [info ] [Thread-1 (]: 1 of 1 START seed file public.tmdb_5000_credits ................................ [RUN]
[0m18:09:45.222334 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:09:45.222482 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:09:45.222634 [debug] [Thread-1 (]: finished collecting timing info
[0m18:09:45.222777 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:09:45.702509 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:09:45.702736 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: BEGIN
[0m18:09:45.702896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:45.711683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:09:45.711892 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:09:45.712041 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "seed.sample_1.tmdb_5000_credits"} */
truncate table "template1"."public"."tmdb_5000_credits"
[0m18:09:45.747484 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.04 seconds
[0m18:09:50.459297 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:09:50.459532 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: 
          insert into "template1"."public"."tmdb_5000_credits" ("movie_id", "title", "cast", "crew") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(...
[0m18:09:51.274889 [debug] [Thread-1 (]: SQL status: INSERT 0 4803 in 0.82 seconds
[0m18:09:51.282658 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:09:51.296136 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:09:51.296328 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:09:51.296472 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:09:51.918914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.62 seconds
[0m18:09:51.919718 [debug] [Thread-1 (]: finished collecting timing info
[0m18:09:51.919952 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: Close
[0m18:09:51.922004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1947b3-d173-4e1e-83a8-009580dd2e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d43f07c10>]}
[0m18:09:51.922357 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.tmdb_5000_credits ............................ [[32mINSERT 4803[0m in 6.70s]
[0m18:09:51.922798 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:09:51.923934 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:09:51.924116 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:51.924243 [debug] [MainThread]: On master: BEGIN
[0m18:09:51.924374 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:51.933113 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:09:51.933458 [debug] [MainThread]: On master: COMMIT
[0m18:09:51.933589 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:51.933711 [debug] [MainThread]: On master: COMMIT
[0m18:09:51.933962 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:09:51.934145 [debug] [MainThread]: On master: Close
[0m18:09:51.934907 [info ] [MainThread]: 
[0m18:09:51.935291 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.79 seconds (6.79s).
[0m18:09:51.935553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:51.935678 [debug] [MainThread]: Connection 'seed.sample_1.tmdb_5000_credits' was properly closed.
[0m18:09:51.942456 [info ] [MainThread]: 
[0m18:09:51.942746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:51.942976 [info ] [MainThread]: 
[0m18:09:51.943156 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:09:51.943416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d43f00040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d43f07700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d43f20c10>]}
[0m18:09:51.943617 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:11:22.097281 | e07aa891-7a98-4bd5-a283-64dc5eb91d48 ==============================
[0m18:11:22.097312 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:11:22.097708 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:11:22.097873 [debug] [MainThread]: Tracking: tracking
[0m18:11:22.098914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48bfcce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48bfce680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48bfce620>]}
[0m18:11:22.141031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:11:22.141246 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:11:22.146759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e07aa891-7a98-4bd5-a283-64dc5eb91d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48b37c0d0>]}
[0m18:11:22.152731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e07aa891-7a98-4bd5-a283-64dc5eb91d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48b348cd0>]}
[0m18:11:22.153074 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:11:22.153401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e07aa891-7a98-4bd5-a283-64dc5eb91d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48dba2a70>]}
[0m18:11:22.154503 [info ] [MainThread]: 
[0m18:11:22.155127 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:11:22.156085 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1"
[0m18:11:22.209580 [debug] [ThreadPool]: Using postgres connection "list_template1"
[0m18:11:22.209860 [debug] [ThreadPool]: On list_template1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1"} */

    select distinct nspname from pg_namespace
  
[0m18:11:22.210049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:22.220687 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m18:11:22.222041 [debug] [ThreadPool]: On list_template1: Close
[0m18:11:22.223614 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_public"
[0m18:11:22.229064 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:11:22.229233 [debug] [ThreadPool]: On list_template1_public: BEGIN
[0m18:11:22.229415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:22.238472 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:11:22.238680 [debug] [ThreadPool]: Using postgres connection "list_template1_public"
[0m18:11:22.238840 [debug] [ThreadPool]: On list_template1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_public"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:11:22.240854 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:11:22.242073 [debug] [ThreadPool]: On list_template1_public: ROLLBACK
[0m18:11:22.242358 [debug] [ThreadPool]: On list_template1_public: Close
[0m18:11:22.246726 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:22.246900 [debug] [MainThread]: On master: BEGIN
[0m18:11:22.247063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:22.256215 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:11:22.256416 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:22.256555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:11:22.263065 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:11:22.264180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e07aa891-7a98-4bd5-a283-64dc5eb91d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48b348be0>]}
[0m18:11:22.264460 [debug] [MainThread]: On master: ROLLBACK
[0m18:11:22.264750 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:22.264878 [debug] [MainThread]: On master: BEGIN
[0m18:11:22.265167 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:22.265318 [debug] [MainThread]: On master: COMMIT
[0m18:11:22.265454 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:22.265576 [debug] [MainThread]: On master: COMMIT
[0m18:11:22.265846 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:11:22.266004 [debug] [MainThread]: On master: Close
[0m18:11:22.266562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:22.266809 [info ] [MainThread]: 
[0m18:11:22.269380 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:11:22.269643 [info ] [Thread-1 (]: 1 of 1 START sql table model public.tmdb_credits ............................... [RUN]
[0m18:11:22.270183 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:11:22.270319 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:11:22.270448 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:11:22.273126 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:11:22.273454 [debug] [Thread-1 (]: finished collecting timing info
[0m18:11:22.273616 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:11:22.312170 [debug] [Thread-1 (]: Writing runtime sql for node "model.sample_1.tmdb_credits"
[0m18:11:22.312691 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:11:22.312858 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: BEGIN
[0m18:11:22.313028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:22.322665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:11:22.322969 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:11:22.323178 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */

  
    

  create  table "template1"."public"."tmdb_credits__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with credits as (

    select movie_id, title
    from "template1"."public"."tmdb_5000_credits"
    order by title asc

)

select *
from credits

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:11:22.487182 [debug] [Thread-1 (]: SQL status: SELECT 4803 in 0.16 seconds
[0m18:11:22.493798 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:11:22.493978 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
alter table "template1"."public"."tmdb_credits__dbt_tmp" rename to "tmdb_credits"
[0m18:11:22.494396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:22.515171 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: COMMIT
[0m18:11:22.515387 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:11:22.515511 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: COMMIT
[0m18:11:22.573022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.06 seconds
[0m18:11:22.579191 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:11:22.579427 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
drop table if exists "template1"."public"."tmdb_credits__dbt_backup" cascade
[0m18:11:22.579935 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:11:22.581003 [debug] [Thread-1 (]: finished collecting timing info
[0m18:11:22.581174 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: Close
[0m18:11:22.581740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07aa891-7a98-4bd5-a283-64dc5eb91d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48af2d810>]}
[0m18:11:22.582077 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.tmdb_credits .......................... [[32mSELECT 4803[0m in 0.31s]
[0m18:11:22.582526 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:11:22.583668 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:11:22.583864 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:22.583986 [debug] [MainThread]: On master: BEGIN
[0m18:11:22.584120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:22.592544 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:11:22.592789 [debug] [MainThread]: On master: COMMIT
[0m18:11:22.592956 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:22.593109 [debug] [MainThread]: On master: COMMIT
[0m18:11:22.593309 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:11:22.593475 [debug] [MainThread]: On master: Close
[0m18:11:22.594184 [info ] [MainThread]: 
[0m18:11:22.594604 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m18:11:22.594875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:22.595008 [debug] [MainThread]: Connection 'model.sample_1.tmdb_credits' was properly closed.
[0m18:11:22.602201 [info ] [MainThread]: 
[0m18:11:22.602848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:22.603153 [info ] [MainThread]: 
[0m18:11:22.603346 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:11:22.603697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48af4e230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48af2e230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd48b3e46d0>]}
[0m18:11:22.603932 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:17:46.312310 | ef359878-1f31-4a78-adee-ed800b34e126 ==============================
[0m18:17:46.312319 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:17:46.312678 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m18:17:46.312832 [debug] [MainThread]: Tracking: tracking
[0m18:17:46.313872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fad05060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fad07400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fad06f20>]}
[0m18:17:46.373406 [debug] [MainThread]: Executing "git --help"
[0m18:17:46.375044 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:17:46.375258 [debug] [MainThread]: STDERR: "b''"
[0m18:17:46.376532 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m18:17:46.376691 [debug] [MainThread]: Using postgres connection "debug"
[0m18:17:46.376810 [debug] [MainThread]: On debug: select 1 as id
[0m18:17:46.376919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:46.387094 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:17:46.388276 [debug] [MainThread]: On debug: Close
[0m18:17:46.388900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fadf5870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fadf4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fadf5180>]}
[0m18:17:46.389422 [debug] [MainThread]: Flushing usage events
[0m18:17:47.105708 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-28 18:20:39.872687 | ed211a34-cb24-4d6d-a7d8-b70f00cd633e ==============================
[0m18:20:39.872697 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:20:39.873056 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:20:39.873246 [debug] [MainThread]: Tracking: tracking
[0m18:20:39.874369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a36d8040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a36d8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a36d8df0>]}
[0m18:20:39.904049 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:20:39.904498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed211a34-cb24-4d6d-a7d8-b70f00cd633e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a576b190>]}
[0m18:20:39.915876 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:20:39.937837 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:20:39.939815 [debug] [MainThread]: Parsing macros/relations.sql
[0m18:20:39.940982 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m18:20:39.942658 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m18:20:39.944159 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m18:20:39.945012 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:20:39.945934 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:20:39.946484 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:20:39.947527 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:20:39.947960 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:20:39.949207 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:20:39.954497 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:20:39.957685 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:20:39.959662 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:20:39.961142 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:20:39.962731 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:20:39.966309 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:20:39.980932 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:20:39.986329 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:20:39.999342 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:20:40.009780 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:20:40.011126 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:20:40.054274 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:20:40.057285 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:20:40.061591 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:20:40.064247 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:20:40.065347 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:20:40.069646 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:20:40.071525 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:20:40.079781 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:20:40.085505 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:20:40.099431 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:20:40.111720 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:20:40.112938 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:20:40.119484 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:20:40.120613 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:20:40.121378 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:20:40.122070 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:20:40.122664 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:20:40.123600 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:20:40.124599 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:20:40.125560 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:20:40.126824 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:20:40.127731 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:20:40.128450 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:20:40.129420 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:20:40.130335 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:20:40.131273 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:20:40.132081 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:20:40.132921 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:20:40.133863 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:20:40.134667 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:20:40.135602 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:20:40.136643 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:20:40.138432 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:20:40.139155 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:20:40.140200 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:20:40.141105 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:20:40.142620 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:20:40.143525 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:20:40.145458 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:20:40.146529 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:20:40.152127 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:20:40.156453 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:20:40.163148 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:20:40.165153 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:20:40.166468 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:20:40.167672 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:20:40.172557 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:20:40.178577 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:20:40.189758 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:20:40.191557 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:20:40.193166 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:20:40.195547 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:20:40.199279 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:20:40.211515 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:20:40.219320 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:20:40.222133 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:20:40.434407 [debug] [MainThread]: 1699: static parser successfully parsed example/tmdb_credits.sql
[0m18:20:40.516495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed211a34-cb24-4d6d-a7d8-b70f00cd633e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a2daf550>]}
[0m18:20:40.528799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed211a34-cb24-4d6d-a7d8-b70f00cd633e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a36d8ac0>]}
[0m18:20:40.529119 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:20:40.529389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed211a34-cb24-4d6d-a7d8-b70f00cd633e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a3146a10>]}
[0m18:20:40.530436 [info ] [MainThread]: 
[0m18:20:40.530969 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:20:40.531705 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:20:40.541513 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:20:40.541744 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:20:40.541889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:40.553073 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:20:40.553336 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:20:40.553465 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:20:40.555344 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:20:40.556518 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:20:40.556782 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:20:40.562077 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:40.562399 [debug] [MainThread]: On master: BEGIN
[0m18:20:40.562565 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:40.571927 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:20:40.572170 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:40.572295 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:20:40.579201 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:20:40.580296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed211a34-cb24-4d6d-a7d8-b70f00cd633e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a2dae350>]}
[0m18:20:40.580542 [debug] [MainThread]: On master: ROLLBACK
[0m18:20:40.580810 [debug] [MainThread]: On master: Close
[0m18:20:40.581366 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:20:40.581635 [info ] [MainThread]: 
[0m18:20:40.584083 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:20:40.584559 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:20:40.584708 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:20:40.584854 [debug] [Thread-1 (]: Compiling seed.sample_1.tmdb_5000_credits
[0m18:20:40.586498 [debug] [Thread-1 (]: Writing injected SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:20:40.586659 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.586836 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:20:40.587003 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.587463 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:20:40.587936 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:20:40.588392 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:20:40.588530 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:20:40.588662 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:20:40.592807 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:20:40.593275 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.593514 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:20:40.593675 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.594634 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:20:40.595907 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:20:40.596584 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:20:40.596742 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:20:40.596867 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:20:40.607943 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:20:40.608312 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.608481 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:20:40.608607 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.609117 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:20:40.609314 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:20:40.609758 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:20:40.609981 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:20:40.610123 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:20:40.613637 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:20:40.613898 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.614066 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:20:40.614208 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.614641 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:20:40.614822 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:20:40.615301 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:20:40.615427 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:20:40.615563 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:20:40.620738 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:20:40.621013 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.621168 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:20:40.621322 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:40.621778 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:20:40.622514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:40.622651 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m18:20:40.637714 [info ] [MainThread]: Done.
[0m18:20:40.638067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a2dafa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a290e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a290f400>]}
[0m18:20:40.638287 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:20:46.516793 | ee46fc7e-362a-46ba-bbb4-de00c3deba53 ==============================
[0m18:20:46.516804 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:20:46.517162 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m18:20:46.517333 [debug] [MainThread]: Tracking: tracking
[0m18:20:46.518431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844aff0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844aff0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844aff0df0>]}
[0m18:20:46.558810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:20:46.559071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:20:46.564646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee46fc7e-362a-46ba-bbb4-de00c3deba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844a3a40d0>]}
[0m18:20:46.570389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee46fc7e-362a-46ba-bbb4-de00c3deba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844a370d00>]}
[0m18:20:46.570707 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:20:46.570934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee46fc7e-362a-46ba-bbb4-de00c3deba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844d0cb820>]}
[0m18:20:46.571987 [info ] [MainThread]: 
[0m18:20:46.572555 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:20:46.573370 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1"
[0m18:20:46.619651 [debug] [ThreadPool]: Using postgres connection "list_template1"
[0m18:20:46.619875 [debug] [ThreadPool]: On list_template1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1"} */

    select distinct nspname from pg_namespace
  
[0m18:20:46.620026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:46.630398 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m18:20:46.631635 [debug] [ThreadPool]: On list_template1: Close
[0m18:20:46.632746 [debug] [ThreadPool]: Acquiring new postgres connection "create_template1_test_1"
[0m18:20:46.633226 [debug] [ThreadPool]: Acquiring new postgres connection "create_template1_test_1"
[0m18:20:46.633543 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='template1', schema='test_1', identifier=None)"
[0m18:20:46.638579 [debug] [ThreadPool]: Using postgres connection "create_template1_test_1"
[0m18:20:46.638732 [debug] [ThreadPool]: On create_template1_test_1: BEGIN
[0m18:20:46.638876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:20:46.647803 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:20:46.648002 [debug] [ThreadPool]: Using postgres connection "create_template1_test_1"
[0m18:20:46.648144 [debug] [ThreadPool]: On create_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "create_template1_test_1"} */
create schema if not exists "test_1"
[0m18:20:46.648704 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:20:46.649837 [debug] [ThreadPool]: On create_template1_test_1: COMMIT
[0m18:20:46.649986 [debug] [ThreadPool]: Using postgres connection "create_template1_test_1"
[0m18:20:46.650114 [debug] [ThreadPool]: On create_template1_test_1: COMMIT
[0m18:20:46.725581 [debug] [ThreadPool]: SQL status: COMMIT in 0.08 seconds
[0m18:20:46.726077 [debug] [ThreadPool]: On create_template1_test_1: Close
[0m18:20:46.730278 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:20:46.737249 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:20:46.737512 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:20:46.737687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:20:46.748034 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:20:46.748264 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:20:46.748425 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:20:46.750723 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:20:46.751918 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:20:46.752203 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:20:46.757273 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:46.757495 [debug] [MainThread]: On master: BEGIN
[0m18:20:46.757654 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:46.768055 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:20:46.768302 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:46.768473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:20:46.777133 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:20:46.778431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee46fc7e-362a-46ba-bbb4-de00c3deba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844a3db490>]}
[0m18:20:46.778747 [debug] [MainThread]: On master: ROLLBACK
[0m18:20:46.779070 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:46.779239 [debug] [MainThread]: On master: BEGIN
[0m18:20:46.779635 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:20:46.779808 [debug] [MainThread]: On master: COMMIT
[0m18:20:46.779953 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:46.780091 [debug] [MainThread]: On master: COMMIT
[0m18:20:46.780312 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:20:46.780473 [debug] [MainThread]: On master: Close
[0m18:20:46.781107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:20:46.781424 [info ] [MainThread]: 
[0m18:20:46.784347 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:20:46.784736 [info ] [Thread-1 (]: 1 of 1 START seed file test_1.tmdb_5000_credits ................................ [RUN]
[0m18:20:46.785373 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:20:46.785527 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:20:46.785673 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:46.785810 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:20:47.271360 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:20:47.271606 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: BEGIN
[0m18:20:47.271762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:47.281000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:20:47.281241 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:20:47.281384 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "seed.sample_1.tmdb_5000_credits"} */

    create table "template1"."test_1"."tmdb_5000_credits" ("movie_id" integer,"title" text,"cast" text,"crew" text)
  
[0m18:20:47.342203 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.06 seconds
[0m18:20:51.939319 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:20:51.939568 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: 
          insert into "template1"."test_1"."tmdb_5000_credits" ("movie_id", "title", "cast", "crew") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(...
[0m18:20:52.776831 [debug] [Thread-1 (]: SQL status: INSERT 0 4803 in 0.84 seconds
[0m18:20:52.784418 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:20:52.801078 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:20:52.801269 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:20:52.801401 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:20:52.916246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.11 seconds
[0m18:20:52.917875 [debug] [Thread-1 (]: finished collecting timing info
[0m18:20:52.918122 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: Close
[0m18:20:52.920528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee46fc7e-362a-46ba-bbb4-de00c3deba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844a3efbe0>]}
[0m18:20:52.920879 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file test_1.tmdb_5000_credits ............................ [[32mINSERT 4803[0m in 6.14s]
[0m18:20:52.921310 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:20:52.922352 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:20:52.922561 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:52.922703 [debug] [MainThread]: On master: BEGIN
[0m18:20:52.922849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:20:52.931561 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:20:52.931802 [debug] [MainThread]: On master: COMMIT
[0m18:20:52.931939 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:52.932071 [debug] [MainThread]: On master: COMMIT
[0m18:20:52.932370 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:20:52.932545 [debug] [MainThread]: On master: Close
[0m18:20:52.933318 [info ] [MainThread]: 
[0m18:20:52.933744 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.36 seconds (6.36s).
[0m18:20:52.934015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:52.934148 [debug] [MainThread]: Connection 'seed.sample_1.tmdb_5000_credits' was properly closed.
[0m18:20:52.952408 [info ] [MainThread]: 
[0m18:20:52.953102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:20:52.953420 [info ] [MainThread]: 
[0m18:20:52.953671 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:20:52.954021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844a754a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844afd85e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844a3f4970>]}
[0m18:20:52.954269 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:21:48.538258 | c66600ed-a43c-46a3-95da-420e3308ee03 ==============================
[0m18:21:48.538269 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:21:48.538690 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:21:48.538868 [debug] [MainThread]: Tracking: tracking
[0m18:21:48.539951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce59d4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce59d4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce59d4e50>]}
[0m18:21:48.582891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:21:48.583101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:21:48.588557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c66600ed-a43c-46a3-95da-420e3308ee03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce4d880d0>]}
[0m18:21:48.594364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c66600ed-a43c-46a3-95da-420e3308ee03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce4d54d30>]}
[0m18:21:48.594696 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:21:48.594992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66600ed-a43c-46a3-95da-420e3308ee03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce7a9b820>]}
[0m18:21:48.596155 [info ] [MainThread]: 
[0m18:21:48.596970 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:21:48.598252 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1"
[0m18:21:48.649647 [debug] [ThreadPool]: Using postgres connection "list_template1"
[0m18:21:48.649918 [debug] [ThreadPool]: On list_template1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1"} */

    select distinct nspname from pg_namespace
  
[0m18:21:48.650109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:48.661539 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m18:21:48.662796 [debug] [ThreadPool]: On list_template1: Close
[0m18:21:48.664351 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:21:48.670015 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:21:48.670183 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:21:48.670326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:21:48.679283 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:21:48.679488 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:21:48.679626 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:21:48.681623 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:21:48.682782 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:21:48.683079 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:21:48.687420 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:48.687599 [debug] [MainThread]: On master: BEGIN
[0m18:21:48.687739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:21:48.696717 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:21:48.696922 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:48.697064 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:21:48.704797 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:21:48.705944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66600ed-a43c-46a3-95da-420e3308ee03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce4d544f0>]}
[0m18:21:48.706233 [debug] [MainThread]: On master: ROLLBACK
[0m18:21:48.706540 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:48.706672 [debug] [MainThread]: On master: BEGIN
[0m18:21:48.707125 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:21:48.707262 [debug] [MainThread]: On master: COMMIT
[0m18:21:48.707413 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:48.707531 [debug] [MainThread]: On master: COMMIT
[0m18:21:48.707739 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:21:48.707879 [debug] [MainThread]: On master: Close
[0m18:21:48.708437 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:21:48.708709 [info ] [MainThread]: 
[0m18:21:48.711254 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:21:48.711531 [info ] [Thread-1 (]: 1 of 1 START sql table model test_1.tmdb_credits ............................... [RUN]
[0m18:21:48.712083 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:21:48.712235 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:21:48.712372 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:21:48.715222 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:21:48.715567 [debug] [Thread-1 (]: finished collecting timing info
[0m18:21:48.715717 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:21:48.753721 [debug] [Thread-1 (]: Writing runtime sql for node "model.sample_1.tmdb_credits"
[0m18:21:48.754225 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:21:48.754412 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: BEGIN
[0m18:21:48.754551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:48.763702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:21:48.763915 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:21:48.764061 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */

  
    

  create  table "template1"."test_1"."tmdb_credits__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with credits as (

    select movie_id, title
    from "template1"."test_1"."tmdb_5000_credits"
    order by title asc

)

select *
from credits

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:21:48.885060 [debug] [Thread-1 (]: SQL status: SELECT 4803 in 0.12 seconds
[0m18:21:48.891827 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:21:48.891988 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
alter table "template1"."test_1"."tmdb_credits__dbt_tmp" rename to "tmdb_credits"
[0m18:21:48.892381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:21:48.913954 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: COMMIT
[0m18:21:48.914172 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:21:48.914319 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: COMMIT
[0m18:21:48.952350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m18:21:48.959420 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:21:48.959613 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
drop table if exists "template1"."test_1"."tmdb_credits__dbt_backup" cascade
[0m18:21:48.960022 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:21:48.961244 [debug] [Thread-1 (]: finished collecting timing info
[0m18:21:48.961456 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: Close
[0m18:21:48.962122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c66600ed-a43c-46a3-95da-420e3308ee03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce4935780>]}
[0m18:21:48.962515 [info ] [Thread-1 (]: 1 of 1 OK created sql table model test_1.tmdb_credits .......................... [[32mSELECT 4803[0m in 0.25s]
[0m18:21:48.962988 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:21:48.964209 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:21:48.964436 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:48.964592 [debug] [MainThread]: On master: BEGIN
[0m18:21:48.964740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:21:48.976186 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:21:48.976533 [debug] [MainThread]: On master: COMMIT
[0m18:21:48.976703 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:48.976864 [debug] [MainThread]: On master: COMMIT
[0m18:21:48.977205 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:21:48.977423 [debug] [MainThread]: On master: Close
[0m18:21:48.978130 [info ] [MainThread]: 
[0m18:21:48.978437 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m18:21:48.978713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:48.978857 [debug] [MainThread]: Connection 'model.sample_1.tmdb_credits' was properly closed.
[0m18:21:48.988251 [info ] [MainThread]: 
[0m18:21:48.988651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:21:48.988936 [info ] [MainThread]: 
[0m18:21:48.989131 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:21:48.989497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce49160b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce4937ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce4ded270>]}
[0m18:21:48.989802 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:25:14.891114 | 04da2909-f01a-4581-a3c0-1bea9ebe3671 ==============================
[0m18:25:14.891125 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:25:14.891541 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:25:14.891721 [debug] [MainThread]: Tracking: tracking
[0m18:25:14.892817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797de0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797de0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797de0e50>]}
[0m18:25:14.936236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:25:14.936598 [debug] [MainThread]: Partial parsing: added file: sample_1://tests/check_for_credits_data.sql
[0m18:25:15.012261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04da2909-f01a-4581-a3c0-1bea9ebe3671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797187370>]}
[0m18:25:15.018087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04da2909-f01a-4581-a3c0-1bea9ebe3671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797147e80>]}
[0m18:25:15.018434 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:25:15.018703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04da2909-f01a-4581-a3c0-1bea9ebe3671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9799e3f820>]}
[0m18:25:15.019812 [info ] [MainThread]: 
[0m18:25:15.020400 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:25:15.021309 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:25:15.030816 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:25:15.031154 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:25:15.031395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:15.042445 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:25:15.042720 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:25:15.042888 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:25:15.044994 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:25:15.046762 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:25:15.047358 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:25:15.053988 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:15.054288 [debug] [MainThread]: On master: BEGIN
[0m18:25:15.054466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:15.063679 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:25:15.063898 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:15.064035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:25:15.072492 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:25:15.073659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04da2909-f01a-4581-a3c0-1bea9ebe3671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797160e50>]}
[0m18:25:15.073955 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:15.074250 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:15.074385 [debug] [MainThread]: On master: BEGIN
[0m18:25:15.074815 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:15.074967 [debug] [MainThread]: On master: COMMIT
[0m18:25:15.075092 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:15.075208 [debug] [MainThread]: On master: COMMIT
[0m18:25:15.075451 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:15.075607 [debug] [MainThread]: On master: Close
[0m18:25:15.076168 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:15.076452 [info ] [MainThread]: 
[0m18:25:15.079302 [debug] [Thread-1 (]: Began running node test.sample_1.check_for_credits_data
[0m18:25:15.079468 [info ] [Thread-1 (]: 1 of 4 START test check_for_credits_data ....................................... [RUN]
[0m18:25:15.079966 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.check_for_credits_data"
[0m18:25:15.080106 [debug] [Thread-1 (]: Began compiling node test.sample_1.check_for_credits_data
[0m18:25:15.080292 [debug] [Thread-1 (]: Compiling test.sample_1.check_for_credits_data
[0m18:25:15.081787 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.check_for_credits_data"
[0m18:25:15.082085 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:15.082307 [debug] [Thread-1 (]: Began executing node test.sample_1.check_for_credits_data
[0m18:25:15.098280 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.check_for_credits_data"
[0m18:25:15.098809 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.check_for_credits_data"
[0m18:25:15.099611 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: BEGIN
[0m18:25:15.099797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:15.109025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:15.109498 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.check_for_credits_data"
[0m18:25:15.109791 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.check_for_credits_data"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from tmdb_credits
      
    ) dbt_internal_test
[0m18:25:15.111437 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:15.114272 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:15.114580 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: ROLLBACK
[0m18:25:15.114999 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: Close
[0m18:25:15.115702 [error] [Thread-1 (]: 1 of 4 FAIL 4803 check_for_credits_data ........................................ [[31mFAIL 4803[0m in 0.04s]
[0m18:25:15.116139 [debug] [Thread-1 (]: Finished running node test.sample_1.check_for_credits_data
[0m18:25:15.116336 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:25:15.116626 [info ] [Thread-1 (]: 2 of 4 START test not_null_tmdb_credits_movie_id ............................... [RUN]
[0m18:25:15.117211 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:25:15.117445 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:25:15.117640 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:25:15.127295 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:25:15.127676 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:15.127860 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:25:15.129853 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:25:15.130273 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:25:15.130414 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: BEGIN
[0m18:25:15.130588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:15.140884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:15.141238 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:25:15.141462 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "template1"."test_1"."tmdb_credits"
where movie_id is null



      
    ) dbt_internal_test
[0m18:25:15.142640 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:15.144083 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:15.144271 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: ROLLBACK
[0m18:25:15.144577 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: Close
[0m18:25:15.145224 [info ] [Thread-1 (]: 2 of 4 PASS not_null_tmdb_credits_movie_id ..................................... [[32mPASS[0m in 0.03s]
[0m18:25:15.145806 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:25:15.146030 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:25:15.146319 [info ] [Thread-1 (]: 3 of 4 START test not_null_tmdb_credits_title .................................. [RUN]
[0m18:25:15.146909 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:25:15.147079 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:25:15.147230 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:25:15.151322 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:25:15.151637 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:15.151786 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:25:15.153701 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:25:15.153967 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:25:15.154088 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: BEGIN
[0m18:25:15.154212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:15.163299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:15.163494 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:25:15.163619 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from "template1"."test_1"."tmdb_credits"
where title is null



      
    ) dbt_internal_test
[0m18:25:15.164688 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:15.166484 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:15.166825 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: ROLLBACK
[0m18:25:15.167314 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: Close
[0m18:25:15.168134 [info ] [Thread-1 (]: 3 of 4 PASS not_null_tmdb_credits_title ........................................ [[32mPASS[0m in 0.02s]
[0m18:25:15.168643 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:25:15.168865 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:25:15.169030 [info ] [Thread-1 (]: 4 of 4 START test unique_tmdb_credits_movie_id ................................. [RUN]
[0m18:25:15.169700 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:25:15.170086 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:25:15.170278 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:25:15.178961 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:25:15.179371 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:15.179568 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:25:15.181546 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:25:15.181833 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:25:15.181952 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: BEGIN
[0m18:25:15.182084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:15.190978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:25:15.191191 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:25:15.191333 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    movie_id as unique_field,
    count(*) as n_records

from "template1"."test_1"."tmdb_credits"
where movie_id is not null
group by movie_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:25:15.194085 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:15.195405 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:15.195573 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: ROLLBACK
[0m18:25:15.195824 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: Close
[0m18:25:15.196832 [info ] [Thread-1 (]: 4 of 4 PASS unique_tmdb_credits_movie_id ....................................... [[32mPASS[0m in 0.03s]
[0m18:25:15.197496 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:25:15.199311 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:25:15.199588 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:15.199755 [debug] [MainThread]: On master: BEGIN
[0m18:25:15.199884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:15.209846 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:25:15.210146 [debug] [MainThread]: On master: COMMIT
[0m18:25:15.210326 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:15.210473 [debug] [MainThread]: On master: COMMIT
[0m18:25:15.210731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:15.210909 [debug] [MainThread]: On master: Close
[0m18:25:15.211570 [info ] [MainThread]: 
[0m18:25:15.211869 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:25:15.212137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:15.212250 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m18:25:15.233713 [info ] [MainThread]: 
[0m18:25:15.234334 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:25:15.234759 [info ] [MainThread]: 
[0m18:25:15.235010 [error] [MainThread]: [31mFailure in test check_for_credits_data (tests/check_for_credits_data.sql)[0m
[0m18:25:15.235234 [error] [MainThread]:   Got 4803 results, configured to fail if != 0
[0m18:25:15.235432 [info ] [MainThread]: 
[0m18:25:15.235640 [info ] [MainThread]:   compiled Code at target/compiled/sample_1/tests/check_for_credits_data.sql
[0m18:25:15.235868 [info ] [MainThread]: 
[0m18:25:15.236064 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:25:15.236372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797dc89a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797dcbb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9796daa3b0>]}
[0m18:25:15.236629 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:33:26.994815 | dbd6f7b1-359f-4917-ba9c-b7e87c188ffe ==============================
[0m18:33:26.994824 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:33:26.995187 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m18:33:26.995332 [debug] [MainThread]: Tracking: tracking
[0m18:33:26.996425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7d5fd390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7d5ff2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7d5ff010>]}
[0m18:33:27.056584 [debug] [MainThread]: Executing "git --help"
[0m18:33:27.058192 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:33:27.058396 [debug] [MainThread]: STDERR: "b''"
[0m18:33:27.059483 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m18:33:27.059661 [debug] [MainThread]: Using postgres connection "debug"
[0m18:33:27.059806 [debug] [MainThread]: On debug: select 1 as id
[0m18:33:27.059938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:27.070907 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:33:27.072117 [debug] [MainThread]: On debug: Close
[0m18:33:27.072970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7d4ed780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7d4eea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e7d4ed1e0>]}
[0m18:33:27.073532 [debug] [MainThread]: Flushing usage events
[0m18:33:27.442124 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-28 18:33:31.301606 | 7703c8ca-fdd8-4c62-9ce8-11dee39c64ba ==============================
[0m18:33:31.301616 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:33:31.301998 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:33:31.302160 [debug] [MainThread]: Tracking: tracking
[0m18:33:31.303232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37986e8040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37986e8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37986e8df0>]}
[0m18:33:31.343732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:31.344151 [debug] [MainThread]: Partial parsing: updated file: sample_1://models/example/tmdb_credits.sql
[0m18:33:31.359136 [debug] [MainThread]: 1699: static parser successfully parsed example/tmdb_credits.sql
[0m18:33:31.443263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7703c8ca-fdd8-4c62-9ce8-11dee39c64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3797320df0>]}
[0m18:33:31.449382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7703c8ca-fdd8-4c62-9ce8-11dee39c64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f379779ba60>]}
[0m18:33:31.449712 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:33:31.449944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7703c8ca-fdd8-4c62-9ce8-11dee39c64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f379a81f820>]}
[0m18:33:31.450974 [info ] [MainThread]: 
[0m18:33:31.451501 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:33:31.452226 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:33:31.461622 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:33:31.461899 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:33:31.462068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:31.472965 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:33:31.473246 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:33:31.473434 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:33:31.475523 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:33:31.477286 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:33:31.477990 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:33:31.484048 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:31.484298 [debug] [MainThread]: On master: BEGIN
[0m18:33:31.484470 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:31.493898 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:33:31.494140 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:31.494296 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:31.502769 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:33:31.503912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7703c8ca-fdd8-4c62-9ce8-11dee39c64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f379779b520>]}
[0m18:33:31.504188 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:31.504457 [debug] [MainThread]: On master: Close
[0m18:33:31.505089 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:31.505388 [info ] [MainThread]: 
[0m18:33:31.508867 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:33:31.509713 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:33:31.510003 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:33:31.510251 [debug] [Thread-1 (]: Compiling seed.sample_1.tmdb_5000_credits
[0m18:33:31.512130 [debug] [Thread-1 (]: Writing injected SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:33:31.512451 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.512722 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:33:31.512989 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.513900 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:33:31.514184 [debug] [Thread-1 (]: Began running node test.sample_1.check_for_credits_data
[0m18:33:31.515207 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.check_for_credits_data"
[0m18:33:31.515409 [debug] [Thread-1 (]: Began compiling node test.sample_1.check_for_credits_data
[0m18:33:31.515549 [debug] [Thread-1 (]: Compiling test.sample_1.check_for_credits_data
[0m18:33:31.516936 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.check_for_credits_data"
[0m18:33:31.517250 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.517457 [debug] [Thread-1 (]: Began executing node test.sample_1.check_for_credits_data
[0m18:33:31.517603 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.518120 [debug] [Thread-1 (]: Finished running node test.sample_1.check_for_credits_data
[0m18:33:31.518312 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:33:31.518732 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:33:31.518953 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:33:31.519092 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:33:31.521867 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:33:31.522225 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.522433 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:33:31.522584 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.523102 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:33:31.523762 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:33:31.524269 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:33:31.524416 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:33:31.524545 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:33:31.535830 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:33:31.536175 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.536338 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:33:31.536474 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.536954 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:33:31.537131 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:33:31.537641 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:33:31.537775 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:33:31.537911 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:33:31.541557 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:33:31.541823 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.541975 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:33:31.542125 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.542585 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:33:31.542769 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:33:31.543216 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:33:31.543352 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:33:31.543486 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:33:31.550483 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:33:31.550764 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.550898 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:33:31.551023 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:31.551463 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:33:31.552204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:31.552350 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m18:33:31.583026 [info ] [MainThread]: Done.
[0m18:33:31.583815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3797778730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3797392530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3797390d00>]}
[0m18:33:31.584174 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:33:57.548255 | 6cdc66bc-3c84-4cb4-bc4a-4a80f8da6f9a ==============================
[0m18:33:57.548267 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:33:57.548629 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m18:33:57.548789 [debug] [MainThread]: Tracking: tracking
[0m18:33:57.549851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38787f0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38787f0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38787f0e50>]}
[0m18:33:57.591152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:33:57.591363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:33:57.596658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cdc66bc-3c84-4cb4-bc4a-4a80f8da6f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3877ba80d0>]}
[0m18:33:57.602619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cdc66bc-3c84-4cb4-bc4a-4a80f8da6f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3877b71090>]}
[0m18:33:57.602928 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:33:57.603200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cdc66bc-3c84-4cb4-bc4a-4a80f8da6f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387a927820>]}
[0m18:33:57.604212 [info ] [MainThread]: 
[0m18:33:57.604748 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:33:57.605576 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1"
[0m18:33:57.650710 [debug] [ThreadPool]: Using postgres connection "list_template1"
[0m18:33:57.650960 [debug] [ThreadPool]: On list_template1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1"} */

    select distinct nspname from pg_namespace
  
[0m18:33:57.651138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:57.662903 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m18:33:57.664149 [debug] [ThreadPool]: On list_template1: Close
[0m18:33:57.665665 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:33:57.671056 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:33:57.671235 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:33:57.671380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:57.680356 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:33:57.680557 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:33:57.680697 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:33:57.682711 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:33:57.683858 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:33:57.684150 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:33:57.688430 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:57.688612 [debug] [MainThread]: On master: BEGIN
[0m18:33:57.688752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:57.697683 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:33:57.697872 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:57.698009 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:57.706551 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:33:57.707700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cdc66bc-3c84-4cb4-bc4a-4a80f8da6f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3877b70850>]}
[0m18:33:57.707986 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:57.708300 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:57.708424 [debug] [MainThread]: On master: BEGIN
[0m18:33:57.708810 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:57.708947 [debug] [MainThread]: On master: COMMIT
[0m18:33:57.709076 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:57.709192 [debug] [MainThread]: On master: COMMIT
[0m18:33:57.709433 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:33:57.709591 [debug] [MainThread]: On master: Close
[0m18:33:57.710152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:57.710444 [info ] [MainThread]: 
[0m18:33:57.712954 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:33:57.713225 [info ] [Thread-1 (]: 1 of 1 START seed file test_1.tmdb_5000_credits ................................ [RUN]
[0m18:33:57.713862 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:33:57.714015 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:33:57.714202 [debug] [Thread-1 (]: finished collecting timing info
[0m18:33:57.714357 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:33:58.198131 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:33:58.198364 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: BEGIN
[0m18:33:58.198505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:58.207425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:33:58.207626 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:33:58.207750 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "seed.sample_1.tmdb_5000_credits"} */
truncate table "template1"."test_1"."tmdb_5000_credits"
[0m18:33:58.235468 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.03 seconds
[0m18:34:02.923838 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:34:02.924082 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: 
          insert into "template1"."test_1"."tmdb_5000_credits" ("movie_id", "title", "cast", "crew") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(...
[0m18:34:03.829121 [debug] [Thread-1 (]: SQL status: INSERT 0 4803 in 0.9 seconds
[0m18:34:03.836724 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:34:03.850660 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:34:03.850867 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:34:03.851013 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:34:03.933638 [debug] [Thread-1 (]: SQL status: COMMIT in 0.08 seconds
[0m18:34:03.934313 [debug] [Thread-1 (]: finished collecting timing info
[0m18:34:03.934489 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: Close
[0m18:34:03.936547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cdc66bc-3c84-4cb4-bc4a-4a80f8da6f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3877bf0220>]}
[0m18:34:03.936982 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file test_1.tmdb_5000_credits ............................ [[32mINSERT 4803[0m in 6.22s]
[0m18:34:03.937430 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:34:03.938633 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:34:03.938834 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:03.938951 [debug] [MainThread]: On master: BEGIN
[0m18:34:03.939059 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:03.948082 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:34:03.948335 [debug] [MainThread]: On master: COMMIT
[0m18:34:03.948462 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:03.948580 [debug] [MainThread]: On master: COMMIT
[0m18:34:03.948783 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:03.948921 [debug] [MainThread]: On master: Close
[0m18:34:03.949485 [info ] [MainThread]: 
[0m18:34:03.949726 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.34 seconds (6.34s).
[0m18:34:03.950000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:03.950141 [debug] [MainThread]: Connection 'seed.sample_1.tmdb_5000_credits' was properly closed.
[0m18:34:03.982119 [info ] [MainThread]: 
[0m18:34:03.983088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:03.983606 [info ] [MainThread]: 
[0m18:34:03.984006 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:03.984547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3877b70d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3877baa4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3877bab250>]}
[0m18:34:03.984954 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:34:19.439524 | 7fd30674-f5c2-40ac-86d1-9bd75da8d441 ==============================
[0m18:34:19.439534 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:34:19.439956 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:34:19.440135 [debug] [MainThread]: Tracking: tracking
[0m18:34:19.441218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b526e8040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b526e8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b526e8d90>]}
[0m18:34:19.484181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:19.484394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:19.489773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fd30674-f5c2-40ac-86d1-9bd75da8d441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b517980d0>]}
[0m18:34:19.495904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fd30674-f5c2-40ac-86d1-9bd75da8d441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b51769030>]}
[0m18:34:19.496219 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:34:19.496497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fd30674-f5c2-40ac-86d1-9bd75da8d441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b547e3820>]}
[0m18:34:19.497634 [info ] [MainThread]: 
[0m18:34:19.498190 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:34:19.498967 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1"
[0m18:34:19.549095 [debug] [ThreadPool]: Using postgres connection "list_template1"
[0m18:34:19.549377 [debug] [ThreadPool]: On list_template1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1"} */

    select distinct nspname from pg_namespace
  
[0m18:34:19.549586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:19.561223 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m18:34:19.562580 [debug] [ThreadPool]: On list_template1: Close
[0m18:34:19.564153 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:34:19.569633 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:34:19.569813 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:34:19.569954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:19.578935 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:34:19.579154 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:34:19.579323 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:34:19.581356 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:34:19.582539 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:34:19.582784 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:34:19.587033 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:19.587217 [debug] [MainThread]: On master: BEGIN
[0m18:34:19.587354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:19.595994 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:34:19.596198 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:19.596332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:19.604361 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:34:19.605416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fd30674-f5c2-40ac-86d1-9bd75da8d441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b517687f0>]}
[0m18:34:19.605681 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:19.605992 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:19.606121 [debug] [MainThread]: On master: BEGIN
[0m18:34:19.606455 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:19.606592 [debug] [MainThread]: On master: COMMIT
[0m18:34:19.606708 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:19.606815 [debug] [MainThread]: On master: COMMIT
[0m18:34:19.606996 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:19.607140 [debug] [MainThread]: On master: Close
[0m18:34:19.607646 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:19.607907 [info ] [MainThread]: 
[0m18:34:19.610378 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:34:19.610662 [info ] [Thread-1 (]: 1 of 1 START sql table model test_1.tmdb_credits ............................... [RUN]
[0m18:34:19.611271 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:34:19.611420 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:34:19.611576 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:34:19.614193 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:34:19.614506 [debug] [Thread-1 (]: finished collecting timing info
[0m18:34:19.614669 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:34:19.653236 [debug] [Thread-1 (]: Writing runtime sql for node "model.sample_1.tmdb_credits"
[0m18:34:19.653754 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:34:19.653922 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: BEGIN
[0m18:34:19.654061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:19.663075 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:34:19.663312 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:34:19.663469 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */

  
    

  create  table "template1"."test_1"."tmdb_credits__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/




select movie_id, title
from "template1"."test_1"."tmdb_5000_credits"

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:34:19.721728 [debug] [Thread-1 (]: SQL status: SELECT 4803 in 0.06 seconds
[0m18:34:19.728446 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:34:19.728674 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
alter table "template1"."test_1"."tmdb_credits" rename to "tmdb_credits__dbt_backup"
[0m18:34:19.729175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:19.731417 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:34:19.731559 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
alter table "template1"."test_1"."tmdb_credits__dbt_tmp" rename to "tmdb_credits"
[0m18:34:19.731928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:19.750157 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: COMMIT
[0m18:34:19.750318 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:34:19.750449 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: COMMIT
[0m18:34:19.792876 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m18:34:19.798358 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:34:19.798548 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
drop table if exists "template1"."test_1"."tmdb_credits__dbt_backup" cascade
[0m18:34:19.869923 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.07 seconds
[0m18:34:19.873507 [debug] [Thread-1 (]: finished collecting timing info
[0m18:34:19.873765 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: Close
[0m18:34:19.874586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fd30674-f5c2-40ac-86d1-9bd75da8d441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b517e85b0>]}
[0m18:34:19.875086 [info ] [Thread-1 (]: 1 of 1 OK created sql table model test_1.tmdb_credits .......................... [[32mSELECT 4803[0m in 0.26s]
[0m18:34:19.875639 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:34:19.876876 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:34:19.877087 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:19.877222 [debug] [MainThread]: On master: BEGIN
[0m18:34:19.877360 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:19.887090 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:34:19.887438 [debug] [MainThread]: On master: COMMIT
[0m18:34:19.887590 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:19.887729 [debug] [MainThread]: On master: COMMIT
[0m18:34:19.888067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:19.888261 [debug] [MainThread]: On master: Close
[0m18:34:19.889108 [info ] [MainThread]: 
[0m18:34:19.889902 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m18:34:19.890156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:19.890269 [debug] [MainThread]: Connection 'model.sample_1.tmdb_credits' was properly closed.
[0m18:34:19.915315 [info ] [MainThread]: 
[0m18:34:19.916196 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:19.916549 [info ] [MainThread]: 
[0m18:34:19.916801 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:19.917169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b51317fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b51317430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b517e9300>]}
[0m18:34:19.917448 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:35:00.839282 | fb29d619-59ad-4d8c-8b5e-83dd58bd0a3c ==============================
[0m18:35:00.839293 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:35:00.839661 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:35:00.839817 [debug] [MainThread]: Tracking: tracking
[0m18:35:00.840843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8fdd4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8fdd4df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8fdd4d90>]}
[0m18:35:00.882568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:00.882773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:00.888151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb29d619-59ad-4d8c-8b5e-83dd58bd0a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8f1840d0>]}
[0m18:35:00.894182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb29d619-59ad-4d8c-8b5e-83dd58bd0a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8f151030>]}
[0m18:35:00.894467 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:35:00.894688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb29d619-59ad-4d8c-8b5e-83dd58bd0a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf91e27820>]}
[0m18:35:00.895721 [info ] [MainThread]: 
[0m18:35:00.896279 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:35:00.897410 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:35:00.947894 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:35:00.948181 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:35:00.948379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:00.962063 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:35:00.962319 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:35:00.962475 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:35:00.964514 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:35:00.965774 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:35:00.966075 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:35:00.970543 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:00.970715 [debug] [MainThread]: On master: BEGIN
[0m18:35:00.970856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:00.979632 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:00.979832 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:00.979975 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:00.988373 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:00.989564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb29d619-59ad-4d8c-8b5e-83dd58bd0a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8f150f10>]}
[0m18:35:00.990250 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:00.990559 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:00.990711 [debug] [MainThread]: On master: BEGIN
[0m18:35:00.991086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:00.991239 [debug] [MainThread]: On master: COMMIT
[0m18:35:00.991370 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:00.991497 [debug] [MainThread]: On master: COMMIT
[0m18:35:00.991727 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:00.991883 [debug] [MainThread]: On master: Close
[0m18:35:00.992428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:00.992739 [info ] [MainThread]: 
[0m18:35:00.995452 [debug] [Thread-1 (]: Began running node test.sample_1.check_for_credits_data
[0m18:35:00.995643 [info ] [Thread-1 (]: 1 of 4 START test check_for_credits_data ....................................... [RUN]
[0m18:35:00.996195 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.check_for_credits_data"
[0m18:35:00.996344 [debug] [Thread-1 (]: Began compiling node test.sample_1.check_for_credits_data
[0m18:35:00.996481 [debug] [Thread-1 (]: Compiling test.sample_1.check_for_credits_data
[0m18:35:00.997985 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.check_for_credits_data"
[0m18:35:00.998292 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:00.998453 [debug] [Thread-1 (]: Began executing node test.sample_1.check_for_credits_data
[0m18:35:01.014304 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.check_for_credits_data"
[0m18:35:01.014875 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.check_for_credits_data"
[0m18:35:01.015064 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: BEGIN
[0m18:35:01.015209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:01.025347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:35:01.025710 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.check_for_credits_data"
[0m18:35:01.025925 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.check_for_credits_data"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from tmdb_credits
      
    ) dbt_internal_test
[0m18:35:01.026982 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:35:01.029171 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:01.029422 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: ROLLBACK
[0m18:35:01.029804 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: Close
[0m18:35:01.030512 [error] [Thread-1 (]: 1 of 4 FAIL 4803 check_for_credits_data ........................................ [[31mFAIL 4803[0m in 0.03s]
[0m18:35:01.030971 [debug] [Thread-1 (]: Finished running node test.sample_1.check_for_credits_data
[0m18:35:01.031182 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:35:01.031476 [info ] [Thread-1 (]: 2 of 4 START test not_null_tmdb_credits_movie_id ............................... [RUN]
[0m18:35:01.032081 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:35:01.032346 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:35:01.032488 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:35:01.042133 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:35:01.042464 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:01.042635 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:35:01.044474 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:35:01.044762 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:35:01.044897 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: BEGIN
[0m18:35:01.045021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:01.054236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:35:01.054674 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:35:01.054991 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "template1"."test_1"."tmdb_credits"
where movie_id is null



      
    ) dbt_internal_test
[0m18:35:01.056698 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:35:01.058327 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:01.058616 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: ROLLBACK
[0m18:35:01.058966 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: Close
[0m18:35:01.059652 [info ] [Thread-1 (]: 2 of 4 PASS not_null_tmdb_credits_movie_id ..................................... [[32mPASS[0m in 0.03s]
[0m18:35:01.060139 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:35:01.060373 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:35:01.060632 [info ] [Thread-1 (]: 3 of 4 START test not_null_tmdb_credits_title .................................. [RUN]
[0m18:35:01.061236 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:35:01.061450 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:35:01.061614 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:35:01.067636 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:35:01.088455 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:01.088788 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:35:01.091168 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:35:01.096999 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:35:01.097890 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: BEGIN
[0m18:35:01.098107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:01.107327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:35:01.107565 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:35:01.107723 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from "template1"."test_1"."tmdb_credits"
where title is null



      
    ) dbt_internal_test
[0m18:35:01.108720 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:35:01.110085 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:01.110250 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: ROLLBACK
[0m18:35:01.110484 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: Close
[0m18:35:01.111066 [info ] [Thread-1 (]: 3 of 4 PASS not_null_tmdb_credits_title ........................................ [[32mPASS[0m in 0.05s]
[0m18:35:01.111527 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:35:01.111740 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:35:01.112034 [info ] [Thread-1 (]: 4 of 4 START test unique_tmdb_credits_movie_id ................................. [RUN]
[0m18:35:01.112564 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:35:01.112723 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:35:01.112864 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:35:01.118991 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:35:01.132568 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:01.132885 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:35:01.135190 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:35:01.135551 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:35:01.135702 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: BEGIN
[0m18:35:01.135840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:01.145469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:35:01.145768 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:35:01.145985 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    movie_id as unique_field,
    count(*) as n_records

from "template1"."test_1"."tmdb_credits"
where movie_id is not null
group by movie_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:35:01.149467 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:35:01.151055 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:01.151269 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: ROLLBACK
[0m18:35:01.151615 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: Close
[0m18:35:01.152268 [info ] [Thread-1 (]: 4 of 4 PASS unique_tmdb_credits_movie_id ....................................... [[32mPASS[0m in 0.04s]
[0m18:35:01.152748 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:35:01.154058 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:35:01.154236 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:01.154372 [debug] [MainThread]: On master: BEGIN
[0m18:35:01.154490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:01.163526 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:01.163800 [debug] [MainThread]: On master: COMMIT
[0m18:35:01.163977 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:01.164124 [debug] [MainThread]: On master: COMMIT
[0m18:35:01.164344 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:01.164503 [debug] [MainThread]: On master: Close
[0m18:35:01.165184 [info ] [MainThread]: 
[0m18:35:01.165508 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m18:35:01.165809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:01.165944 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m18:35:01.220257 [info ] [MainThread]: 
[0m18:35:01.220681 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:35:01.220922 [info ] [MainThread]: 
[0m18:35:01.221125 [error] [MainThread]: [31mFailure in test check_for_credits_data (tests/check_for_credits_data.sql)[0m
[0m18:35:01.221351 [error] [MainThread]:   Got 4803 results, configured to fail if != 0
[0m18:35:01.221543 [info ] [MainThread]: 
[0m18:35:01.221742 [info ] [MainThread]:   compiled Code at target/compiled/sample_1/tests/check_for_credits_data.sql
[0m18:35:01.221944 [info ] [MainThread]: 
[0m18:35:01.222119 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:35:01.222395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8fdd5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8fdd58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8f1c24a0>]}
[0m18:35:01.222619 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:35:51.461017 | ea281f68-00f0-461c-a26a-984753bfe7ed ==============================
[0m18:35:51.461028 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:35:51.461472 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:35:51.461649 [debug] [MainThread]: Tracking: tracking
[0m18:35:51.462790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7cbbcc040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7cbbcce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7cbbccdf0>]}
[0m18:35:51.506585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:51.507012 [debug] [MainThread]: Partial parsing: updated file: sample_1://tests/check_for_credits_data.sql
[0m18:35:51.583275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea281f68-00f0-461c-a26a-984753bfe7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7caf737c0>]}
[0m18:35:51.589069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea281f68-00f0-461c-a26a-984753bfe7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7caf37c10>]}
[0m18:35:51.589403 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:35:51.589638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea281f68-00f0-461c-a26a-984753bfe7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7cdcff190>]}
[0m18:35:51.590670 [info ] [MainThread]: 
[0m18:35:51.591196 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:35:51.591940 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:35:51.601491 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:35:51.601775 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:35:51.602001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:51.612896 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:35:51.613159 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:35:51.613333 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:35:51.615313 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:35:51.616677 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:35:51.617185 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:35:51.625077 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:51.625510 [debug] [MainThread]: On master: BEGIN
[0m18:35:51.625787 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:51.635382 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:51.635637 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:51.635804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:51.644452 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:51.645641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea281f68-00f0-461c-a26a-984753bfe7ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7caf4cc70>]}
[0m18:35:51.645914 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:51.646171 [debug] [MainThread]: On master: Close
[0m18:35:51.646787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:51.647096 [info ] [MainThread]: 
[0m18:35:51.649921 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:35:51.650421 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:35:51.650578 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:35:51.650718 [debug] [Thread-1 (]: Compiling seed.sample_1.tmdb_5000_credits
[0m18:35:51.652248 [debug] [Thread-1 (]: Writing injected SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:35:51.652391 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.652537 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:35:51.652694 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.653179 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:35:51.653745 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:35:51.654211 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:35:51.654337 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:35:51.654464 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:35:51.656933 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:35:51.657288 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.657495 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:35:51.657669 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.658136 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:35:51.658782 [debug] [Thread-1 (]: Began running node test.sample_1.check_for_credits_data
[0m18:35:51.659261 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.check_for_credits_data"
[0m18:35:51.659455 [debug] [Thread-1 (]: Began compiling node test.sample_1.check_for_credits_data
[0m18:35:51.659634 [debug] [Thread-1 (]: Compiling test.sample_1.check_for_credits_data
[0m18:35:51.662673 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.check_for_credits_data"
[0m18:35:51.663276 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.663588 [debug] [Thread-1 (]: Began executing node test.sample_1.check_for_credits_data
[0m18:35:51.663870 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.664841 [debug] [Thread-1 (]: Finished running node test.sample_1.check_for_credits_data
[0m18:35:51.665169 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:35:51.665829 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:35:51.666066 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:35:51.666285 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:35:51.680365 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:35:51.680796 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.680991 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:35:51.681142 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.681722 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:35:51.681926 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:35:51.682393 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:35:51.682561 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:35:51.682726 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:35:51.686855 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:35:51.687188 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.687368 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:35:51.687515 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.688006 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:35:51.688196 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:35:51.688743 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:35:51.688873 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:35:51.689031 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:35:51.694752 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:35:51.695025 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.695196 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:35:51.695342 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:51.695797 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:35:51.696634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:51.696758 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m18:35:51.735189 [info ] [MainThread]: Done.
[0m18:35:51.735649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7cab78e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7cab79b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7cab794b0>]}
[0m18:35:51.735915 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:35:57.062530 | 8e4df0cf-e603-43a3-91ea-61e83d9720bc ==============================
[0m18:35:57.062541 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:35:57.062892 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m18:35:57.063055 [debug] [MainThread]: Tracking: tracking
[0m18:35:57.064134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2d9d4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2d9d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2d9d4df0>]}
[0m18:35:57.106873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:57.107124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:57.112581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e4df0cf-e603-43a3-91ea-61e83d9720bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2cd880d0>]}
[0m18:35:57.118619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e4df0cf-e603-43a3-91ea-61e83d9720bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2cd54c70>]}
[0m18:35:57.118948 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:35:57.119230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e4df0cf-e603-43a3-91ea-61e83d9720bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2fb03190>]}
[0m18:35:57.120289 [info ] [MainThread]: 
[0m18:35:57.120806 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:35:57.121620 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1"
[0m18:35:57.171350 [debug] [ThreadPool]: Using postgres connection "list_template1"
[0m18:35:57.171622 [debug] [ThreadPool]: On list_template1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1"} */

    select distinct nspname from pg_namespace
  
[0m18:35:57.171807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:57.182486 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m18:35:57.183751 [debug] [ThreadPool]: On list_template1: Close
[0m18:35:57.185250 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:35:57.190697 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:35:57.190861 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:35:57.191010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:57.199818 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:35:57.200030 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:35:57.200175 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:35:57.202145 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:35:57.203325 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:35:57.203596 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:35:57.208149 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:57.208325 [debug] [MainThread]: On master: BEGIN
[0m18:35:57.208463 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:57.217212 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:35:57.217421 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:57.217561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:57.226315 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:35:57.227555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e4df0cf-e603-43a3-91ea-61e83d9720bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2cd54820>]}
[0m18:35:57.227871 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:57.228144 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:57.228288 [debug] [MainThread]: On master: BEGIN
[0m18:35:57.228624 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:57.228763 [debug] [MainThread]: On master: COMMIT
[0m18:35:57.228894 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:57.229021 [debug] [MainThread]: On master: COMMIT
[0m18:35:57.229207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:57.229375 [debug] [MainThread]: On master: Close
[0m18:35:57.229979 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:57.230274 [info ] [MainThread]: 
[0m18:35:57.232893 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:35:57.233169 [info ] [Thread-1 (]: 1 of 1 START seed file test_1.tmdb_5000_credits ................................ [RUN]
[0m18:35:57.233814 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:35:57.233965 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:35:57.234126 [debug] [Thread-1 (]: finished collecting timing info
[0m18:35:57.234256 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:35:57.719194 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:35:57.719435 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: BEGIN
[0m18:35:57.719619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:57.728694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:35:57.728902 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:35:57.729041 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "seed.sample_1.tmdb_5000_credits"} */
truncate table "template1"."test_1"."tmdb_5000_credits"
[0m18:35:57.766961 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.04 seconds
[0m18:36:02.382520 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:36:02.382786 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: 
          insert into "template1"."test_1"."tmdb_5000_credits" ("movie_id", "title", "cast", "crew") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(...
[0m18:36:03.200825 [debug] [Thread-1 (]: SQL status: INSERT 0 4803 in 0.82 seconds
[0m18:36:03.208549 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:36:03.223039 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:36:03.223268 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:36:03.223409 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:36:03.267292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m18:36:03.268068 [debug] [Thread-1 (]: finished collecting timing info
[0m18:36:03.268288 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: Close
[0m18:36:03.270673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e4df0cf-e603-43a3-91ea-61e83d9720bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2cdd4520>]}
[0m18:36:03.271014 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file test_1.tmdb_5000_credits ............................ [[32mINSERT 4803[0m in 6.04s]
[0m18:36:03.271444 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:36:03.272597 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:36:03.272778 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.272905 [debug] [MainThread]: On master: BEGIN
[0m18:36:03.273021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:36:03.281658 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:36:03.281882 [debug] [MainThread]: On master: COMMIT
[0m18:36:03.282002 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.282118 [debug] [MainThread]: On master: COMMIT
[0m18:36:03.282327 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:36:03.282478 [debug] [MainThread]: On master: Close
[0m18:36:03.283172 [info ] [MainThread]: 
[0m18:36:03.283577 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.16 seconds (6.16s).
[0m18:36:03.283835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:03.283963 [debug] [MainThread]: Connection 'seed.sample_1.tmdb_5000_credits' was properly closed.
[0m18:36:03.290957 [info ] [MainThread]: 
[0m18:36:03.291258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:03.291488 [info ] [MainThread]: 
[0m18:36:03.291668 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:36:03.291962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2cd1e860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2cd54d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc2cd4c1c0>]}
[0m18:36:03.292168 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:36:09.878750 | 1a820a78-9edf-4943-9a0d-20fd1450363a ==============================
[0m18:36:09.878761 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:36:09.879178 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:36:09.879325 [debug] [MainThread]: Tracking: tracking
[0m18:36:09.880375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87bde0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87bde0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87bde0e50>]}
[0m18:36:09.921487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:09.921696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:09.927100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a820a78-9edf-4943-9a0d-20fd1450363a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87b1980d0>]}
[0m18:36:09.932986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a820a78-9edf-4943-9a0d-20fd1450363a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87b160e80>]}
[0m18:36:09.933362 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:36:09.933619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a820a78-9edf-4943-9a0d-20fd1450363a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87df13190>]}
[0m18:36:09.934593 [info ] [MainThread]: 
[0m18:36:09.935126 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:36:09.935881 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1"
[0m18:36:09.981059 [debug] [ThreadPool]: Using postgres connection "list_template1"
[0m18:36:09.981309 [debug] [ThreadPool]: On list_template1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1"} */

    select distinct nspname from pg_namespace
  
[0m18:36:09.981490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:09.991854 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m18:36:09.993086 [debug] [ThreadPool]: On list_template1: Close
[0m18:36:09.994576 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:36:09.999915 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:36:10.000080 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:36:10.000217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:10.008891 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:36:10.009074 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:36:10.009201 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:36:10.011186 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:36:10.012294 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:36:10.012570 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:36:10.016761 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:10.016937 [debug] [MainThread]: On master: BEGIN
[0m18:36:10.017089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:10.025875 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:36:10.026060 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:10.026202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:36:10.034636 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:36:10.035767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a820a78-9edf-4943-9a0d-20fd1450363a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87b160850>]}
[0m18:36:10.036051 [debug] [MainThread]: On master: ROLLBACK
[0m18:36:10.036371 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:10.036515 [debug] [MainThread]: On master: BEGIN
[0m18:36:10.036916 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:36:10.037061 [debug] [MainThread]: On master: COMMIT
[0m18:36:10.037188 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:10.037319 [debug] [MainThread]: On master: COMMIT
[0m18:36:10.037562 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:36:10.037719 [debug] [MainThread]: On master: Close
[0m18:36:10.038316 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:36:10.038614 [info ] [MainThread]: 
[0m18:36:10.041263 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:36:10.041534 [info ] [Thread-1 (]: 1 of 1 START sql table model test_1.tmdb_credits ............................... [RUN]
[0m18:36:10.042122 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:36:10.042272 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:36:10.042445 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:36:10.045111 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:36:10.045462 [debug] [Thread-1 (]: finished collecting timing info
[0m18:36:10.045629 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:36:10.083932 [debug] [Thread-1 (]: Writing runtime sql for node "model.sample_1.tmdb_credits"
[0m18:36:10.084406 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:36:10.084583 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: BEGIN
[0m18:36:10.084719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:10.093920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:36:10.094128 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:36:10.094266 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */

  
    

  create  table "template1"."test_1"."tmdb_credits__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/




select movie_id, title
from "template1"."test_1"."tmdb_5000_credits"

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:36:10.137001 [debug] [Thread-1 (]: SQL status: SELECT 4803 in 0.04 seconds
[0m18:36:10.144116 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:36:10.144303 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
alter table "template1"."test_1"."tmdb_credits" rename to "tmdb_credits__dbt_backup"
[0m18:36:10.144796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:36:10.147010 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:36:10.147145 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
alter table "template1"."test_1"."tmdb_credits__dbt_tmp" rename to "tmdb_credits"
[0m18:36:10.147556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:36:10.166155 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: COMMIT
[0m18:36:10.166452 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:36:10.166613 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: COMMIT
[0m18:36:10.210391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m18:36:10.216401 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:36:10.216577 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
drop table if exists "template1"."test_1"."tmdb_credits__dbt_backup" cascade
[0m18:36:10.259756 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m18:36:10.262287 [debug] [Thread-1 (]: finished collecting timing info
[0m18:36:10.262675 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: Close
[0m18:36:10.263893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a820a78-9edf-4943-9a0d-20fd1450363a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87b1e0220>]}
[0m18:36:10.264614 [info ] [Thread-1 (]: 1 of 1 OK created sql table model test_1.tmdb_credits .......................... [[32mSELECT 4803[0m in 0.22s]
[0m18:36:10.265443 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:36:10.266660 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:36:10.266877 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:10.267034 [debug] [MainThread]: On master: BEGIN
[0m18:36:10.267177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:36:10.281661 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:36:10.281998 [debug] [MainThread]: On master: COMMIT
[0m18:36:10.282141 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:10.282271 [debug] [MainThread]: On master: COMMIT
[0m18:36:10.282620 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:36:10.282804 [debug] [MainThread]: On master: Close
[0m18:36:10.283499 [info ] [MainThread]: 
[0m18:36:10.283882 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:36:10.284117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:10.284239 [debug] [MainThread]: Connection 'model.sample_1.tmdb_credits' was properly closed.
[0m18:36:10.301973 [info ] [MainThread]: 
[0m18:36:10.302323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:10.302587 [info ] [MainThread]: 
[0m18:36:10.302786 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:36:10.303073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87ad440d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87b160d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87b1e04c0>]}
[0m18:36:10.303290 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:36:13.882809 | 600c4b73-c2b0-4e65-89a1-4f4f1955beb7 ==============================
[0m18:36:13.882819 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:36:13.883226 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:36:13.883395 [debug] [MainThread]: Tracking: tracking
[0m18:36:13.884467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedb83e0e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedb83e2680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedb83e2620>]}
[0m18:36:13.927364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:13.927607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:13.933247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '600c4b73-c2b0-4e65-89a1-4f4f1955beb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedb77940d0>]}
[0m18:36:13.939528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '600c4b73-c2b0-4e65-89a1-4f4f1955beb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedb7760eb0>]}
[0m18:36:13.939862 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:36:13.940152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '600c4b73-c2b0-4e65-89a1-4f4f1955beb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedb98deb00>]}
[0m18:36:13.941303 [info ] [MainThread]: 
[0m18:36:13.941862 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:36:13.942743 [debug] [ThreadPool]: Acquiring new postgres connection "list_template1_test_1"
[0m18:36:13.993752 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:36:13.993999 [debug] [ThreadPool]: On list_template1_test_1: BEGIN
[0m18:36:13.994206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:14.004794 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:36:14.005056 [debug] [ThreadPool]: Using postgres connection "list_template1_test_1"
[0m18:36:14.005224 [debug] [ThreadPool]: On list_template1_test_1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_template1_test_1"} */
select
      'template1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test_1'
    union all
    select
      'template1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test_1'
  
[0m18:36:14.007335 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:36:14.008694 [debug] [ThreadPool]: On list_template1_test_1: ROLLBACK
[0m18:36:14.009074 [debug] [ThreadPool]: On list_template1_test_1: Close
[0m18:36:14.015897 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:14.016101 [debug] [MainThread]: On master: BEGIN
[0m18:36:14.016253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:14.024865 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:36:14.025078 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:14.025199 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:36:14.033689 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:36:14.034741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '600c4b73-c2b0-4e65-89a1-4f4f1955beb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedb7760fa0>]}
[0m18:36:14.034999 [debug] [MainThread]: On master: ROLLBACK
[0m18:36:14.035279 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:14.035405 [debug] [MainThread]: On master: BEGIN
[0m18:36:14.035843 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:36:14.035989 [debug] [MainThread]: On master: COMMIT
[0m18:36:14.036112 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:14.036225 [debug] [MainThread]: On master: COMMIT
[0m18:36:14.036434 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:36:14.036572 [debug] [MainThread]: On master: Close
[0m18:36:14.037121 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:36:14.037408 [info ] [MainThread]: 
[0m18:36:14.039867 [debug] [Thread-1 (]: Began running node test.sample_1.check_for_credits_data
[0m18:36:14.040042 [info ] [Thread-1 (]: 1 of 4 START test check_for_credits_data ....................................... [RUN]
[0m18:36:14.040555 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.check_for_credits_data"
[0m18:36:14.040696 [debug] [Thread-1 (]: Began compiling node test.sample_1.check_for_credits_data
[0m18:36:14.040825 [debug] [Thread-1 (]: Compiling test.sample_1.check_for_credits_data
[0m18:36:14.043290 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.check_for_credits_data"
[0m18:36:14.043606 [debug] [Thread-1 (]: finished collecting timing info
[0m18:36:14.043751 [debug] [Thread-1 (]: Began executing node test.sample_1.check_for_credits_data
[0m18:36:14.059257 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.check_for_credits_data"
[0m18:36:14.059716 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.check_for_credits_data"
[0m18:36:14.059894 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: BEGIN
[0m18:36:14.060054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:14.070089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:36:14.070467 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.check_for_credits_data"
[0m18:36:14.070738 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.check_for_credits_data"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from "template1"."test_1"."tmdb_credits"
      
    ) dbt_internal_test
[0m18:36:14.072038 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:14.074339 [debug] [Thread-1 (]: finished collecting timing info
[0m18:36:14.074550 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: ROLLBACK
[0m18:36:14.074964 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: Close
[0m18:36:14.075670 [error] [Thread-1 (]: 1 of 4 FAIL 4803 check_for_credits_data ........................................ [[31mFAIL 4803[0m in 0.04s]
[0m18:36:14.076128 [debug] [Thread-1 (]: Finished running node test.sample_1.check_for_credits_data
[0m18:36:14.076362 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:36:14.076624 [info ] [Thread-1 (]: 2 of 4 START test not_null_tmdb_credits_movie_id ............................... [RUN]
[0m18:36:14.077221 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:36:14.077415 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:36:14.077554 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:36:14.087092 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:36:14.087422 [debug] [Thread-1 (]: finished collecting timing info
[0m18:36:14.087581 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:36:14.089493 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:36:14.089776 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:36:14.090005 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: BEGIN
[0m18:36:14.090210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:14.099563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:36:14.099843 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:36:14.100047 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "template1"."test_1"."tmdb_credits"
where movie_id is null



      
    ) dbt_internal_test
[0m18:36:14.101509 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:14.103700 [debug] [Thread-1 (]: finished collecting timing info
[0m18:36:14.103975 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: ROLLBACK
[0m18:36:14.104283 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: Close
[0m18:36:14.104899 [info ] [Thread-1 (]: 2 of 4 PASS not_null_tmdb_credits_movie_id ..................................... [[32mPASS[0m in 0.03s]
[0m18:36:14.105361 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:36:14.105616 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:36:14.105911 [info ] [Thread-1 (]: 3 of 4 START test not_null_tmdb_credits_title .................................. [RUN]
[0m18:36:14.106506 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:36:14.106667 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:36:14.106834 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:36:14.112486 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:36:14.112918 [debug] [Thread-1 (]: finished collecting timing info
[0m18:36:14.113106 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:36:14.114950 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:36:14.115291 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:36:14.115415 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: BEGIN
[0m18:36:14.115545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:14.124148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:36:14.124353 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:36:14.124504 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from "template1"."test_1"."tmdb_credits"
where title is null



      
    ) dbt_internal_test
[0m18:36:14.125532 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:14.126891 [debug] [Thread-1 (]: finished collecting timing info
[0m18:36:14.127090 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: ROLLBACK
[0m18:36:14.127437 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: Close
[0m18:36:14.128354 [info ] [Thread-1 (]: 3 of 4 PASS not_null_tmdb_credits_title ........................................ [[32mPASS[0m in 0.02s]
[0m18:36:14.128994 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:36:14.129302 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:36:14.129556 [info ] [Thread-1 (]: 4 of 4 START test unique_tmdb_credits_movie_id ................................. [RUN]
[0m18:36:14.130467 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:36:14.130661 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:36:14.130814 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:36:14.138352 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:36:14.138748 [debug] [Thread-1 (]: finished collecting timing info
[0m18:36:14.138951 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:36:14.140986 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:36:14.141377 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:36:14.141528 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: BEGIN
[0m18:36:14.141659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:14.150748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:36:14.150958 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:36:14.151102 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    movie_id as unique_field,
    count(*) as n_records

from "template1"."test_1"."tmdb_credits"
where movie_id is not null
group by movie_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:36:14.153970 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:14.155331 [debug] [Thread-1 (]: finished collecting timing info
[0m18:36:14.155514 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: ROLLBACK
[0m18:36:14.155799 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: Close
[0m18:36:14.156386 [info ] [Thread-1 (]: 4 of 4 PASS unique_tmdb_credits_movie_id ....................................... [[32mPASS[0m in 0.03s]
[0m18:36:14.156777 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:36:14.157826 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:36:14.158038 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:14.158179 [debug] [MainThread]: On master: BEGIN
[0m18:36:14.158308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:36:14.167779 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:36:14.168056 [debug] [MainThread]: On master: COMMIT
[0m18:36:14.168220 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:14.168358 [debug] [MainThread]: On master: COMMIT
[0m18:36:14.168579 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:36:14.168733 [debug] [MainThread]: On master: Close
[0m18:36:14.169412 [info ] [MainThread]: 
[0m18:36:14.169706 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:36:14.169987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:14.170118 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m18:36:14.251125 [info ] [MainThread]: 
[0m18:36:14.251535 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:36:14.251827 [info ] [MainThread]: 
[0m18:36:14.252044 [error] [MainThread]: [31mFailure in test check_for_credits_data (tests/check_for_credits_data.sql)[0m
[0m18:36:14.252240 [error] [MainThread]:   Got 4803 results, configured to fail if != 0
[0m18:36:14.252417 [info ] [MainThread]: 
[0m18:36:14.252593 [info ] [MainThread]:   compiled Code at target/compiled/sample_1/tests/check_for_credits_data.sql
[0m18:36:14.252781 [info ] [MainThread]: 
[0m18:36:14.252958 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:36:14.253219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedb7309c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedb730bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedb77ec910>]}
[0m18:36:14.253465 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:55:07.340729 | 39576169-c031-43dc-b927-d1c9fd2c3169 ==============================
[0m18:55:07.340739 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:55:07.341133 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m18:55:07.341281 [debug] [MainThread]: Tracking: tracking
[0m18:55:07.342451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51541fead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51541fef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51541fcbe0>]}
[0m18:55:07.400516 [debug] [MainThread]: Executing "git --help"
[0m18:55:07.402103 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:55:07.402298 [debug] [MainThread]: STDERR: "b''"
[0m18:55:07.403431 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m18:55:07.403610 [debug] [MainThread]: Using postgres connection "debug"
[0m18:55:07.403767 [debug] [MainThread]: On debug: select 1 as id
[0m18:55:07.403919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:07.414167 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:55:07.415193 [debug] [MainThread]: On debug: Close
[0m18:55:07.415633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51540eceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51540ecf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51540ed1e0>]}
[0m18:55:07.415946 [debug] [MainThread]: Flushing usage events
[0m18:55:07.791174 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-28 18:55:15.078936 | ac32e3f8-75ed-437f-8866-b2be2c042204 ==============================
[0m18:55:15.078947 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:55:15.079374 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:55:15.079551 [debug] [MainThread]: Tracking: tracking
[0m18:55:15.080680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c942e8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c942ea680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c942ea620>]}
[0m18:55:15.109927 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:55:15.110572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac32e3f8-75ed-437f-8866-b2be2c042204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c957e9fc0>]}
[0m18:55:15.122535 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:55:15.144653 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:55:15.146752 [debug] [MainThread]: Parsing macros/relations.sql
[0m18:55:15.148058 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m18:55:15.149826 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m18:55:15.151358 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m18:55:15.152290 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:55:15.153203 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:55:15.153780 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:55:15.154825 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:55:15.155267 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:55:15.156454 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:55:15.161713 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:55:15.164874 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:55:15.166794 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:55:15.168260 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:55:15.169770 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:55:15.173334 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:55:15.187853 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:55:15.193193 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:55:15.206035 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:55:15.216592 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:55:15.218177 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:55:15.258633 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:55:15.261738 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:55:15.266142 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:55:15.269312 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:55:15.270556 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:55:15.275471 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:55:15.277739 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:55:15.286474 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:55:15.292283 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:55:15.305742 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:55:15.318180 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:55:15.319543 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:55:15.326113 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:55:15.327281 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:55:15.328022 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:55:15.328719 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:55:15.329372 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:55:15.330311 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:55:15.331404 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:55:15.332301 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:55:15.333632 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:55:15.334548 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:55:15.335268 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:55:15.336203 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:55:15.337113 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:55:15.338049 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:55:15.338865 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:55:15.339707 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:55:15.340616 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:55:15.341447 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:55:15.342382 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:55:15.343416 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:55:15.345098 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:55:15.345831 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:55:15.346880 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:55:15.347797 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:55:15.349324 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:55:15.350240 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:55:15.352092 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:55:15.353125 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:55:15.358739 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:55:15.363043 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:55:15.369693 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:55:15.371688 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:55:15.372969 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:55:15.374180 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:55:15.379101 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:55:15.385029 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:55:15.396022 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:55:15.397825 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:55:15.399426 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:55:15.401617 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:55:15.405287 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:55:15.416994 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:55:15.424752 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:55:15.427682 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:55:15.637564 [debug] [MainThread]: 1699: static parser successfully parsed example/tmdb_credits.sql
[0m18:55:15.732222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac32e3f8-75ed-437f-8866-b2be2c042204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c93377640>]}
[0m18:55:15.737856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac32e3f8-75ed-437f-8866-b2be2c042204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c937482e0>]}
[0m18:55:15.738181 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:55:15.738430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac32e3f8-75ed-437f-8866-b2be2c042204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c957eaa70>]}
[0m18:55:15.739491 [info ] [MainThread]: 
[0m18:55:15.740065 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:55:15.740854 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial1_public"
[0m18:55:15.750696 [debug] [ThreadPool]: Using postgres connection "list_trial1_public"
[0m18:55:15.750957 [debug] [ThreadPool]: On list_trial1_public: BEGIN
[0m18:55:15.751118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:15.760888 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:55:15.761134 [debug] [ThreadPool]: Using postgres connection "list_trial1_public"
[0m18:55:15.761264 [debug] [ThreadPool]: On list_trial1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_trial1_public"} */
select
      'trial1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:55:15.763338 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:55:15.764576 [debug] [ThreadPool]: On list_trial1_public: ROLLBACK
[0m18:55:15.764884 [debug] [ThreadPool]: On list_trial1_public: Close
[0m18:55:15.770305 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:15.770612 [debug] [MainThread]: On master: BEGIN
[0m18:55:15.770770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:15.780064 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:55:15.780314 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:15.780447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:15.788706 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:55:15.789874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac32e3f8-75ed-437f-8866-b2be2c042204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c933918d0>]}
[0m18:55:15.790120 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:15.790363 [debug] [MainThread]: On master: Close
[0m18:55:15.790900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:15.791183 [info ] [MainThread]: 
[0m18:55:15.793765 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:55:15.794271 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:55:15.794421 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:55:15.794558 [debug] [Thread-1 (]: Compiling seed.sample_1.tmdb_5000_credits
[0m18:55:15.796037 [debug] [Thread-1 (]: Writing injected SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:55:15.796278 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.796460 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:55:15.796909 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.797657 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:55:15.798479 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:55:15.799092 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:55:15.799309 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:55:15.799456 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:55:15.803136 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:55:15.803608 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.803772 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:55:15.803967 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.804586 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:55:15.805215 [debug] [Thread-1 (]: Began running node test.sample_1.check_for_credits_data
[0m18:55:15.805751 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.check_for_credits_data"
[0m18:55:15.805903 [debug] [Thread-1 (]: Began compiling node test.sample_1.check_for_credits_data
[0m18:55:15.806035 [debug] [Thread-1 (]: Compiling test.sample_1.check_for_credits_data
[0m18:55:15.808321 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.check_for_credits_data"
[0m18:55:15.808614 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.808770 [debug] [Thread-1 (]: Began executing node test.sample_1.check_for_credits_data
[0m18:55:15.808917 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.809391 [debug] [Thread-1 (]: Finished running node test.sample_1.check_for_credits_data
[0m18:55:15.809579 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:55:15.810053 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:55:15.810180 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:55:15.810321 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:55:15.820739 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:55:15.821042 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.821196 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:55:15.821353 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.821821 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:55:15.822018 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:55:15.822396 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:55:15.822614 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:55:15.822732 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:55:15.826023 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:55:15.826289 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.826442 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:55:15.826584 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.827197 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:55:15.827384 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:55:15.827806 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:55:15.827930 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:55:15.828067 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:55:15.833380 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:55:15.833641 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.833785 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:55:15.833915 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:15.834362 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:55:15.835083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:15.835237 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m18:55:15.878341 [info ] [MainThread]: Done.
[0m18:55:15.878851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c92b23f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c92b208e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c92b21540>]}
[0m18:55:15.879196 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:55:21.477976 | 102fde49-2c76-49f8-b278-62a09e0332f9 ==============================
[0m18:55:21.477987 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:55:21.478354 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m18:55:21.478628 [debug] [MainThread]: Tracking: tracking
[0m18:55:21.479695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60cf3f0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60cf3f0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60cf3f0df0>]}
[0m18:55:21.520443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:21.520663 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:21.526278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '102fde49-2c76-49f8-b278-62a09e0332f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ce7a00d0>]}
[0m18:55:21.532768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '102fde49-2c76-49f8-b278-62a09e0332f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ce771060>]}
[0m18:55:21.533126 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:55:21.533531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '102fde49-2c76-49f8-b278-62a09e0332f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d1463820>]}
[0m18:55:21.534612 [info ] [MainThread]: 
[0m18:55:21.535220 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:55:21.536521 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial1"
[0m18:55:21.586757 [debug] [ThreadPool]: Using postgres connection "list_trial1"
[0m18:55:21.586995 [debug] [ThreadPool]: On list_trial1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_trial1"} */

    select distinct nspname from pg_namespace
  
[0m18:55:21.587182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:21.597847 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m18:55:21.599175 [debug] [ThreadPool]: On list_trial1: Close
[0m18:55:21.600745 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial1_public"
[0m18:55:21.606355 [debug] [ThreadPool]: Using postgres connection "list_trial1_public"
[0m18:55:21.606521 [debug] [ThreadPool]: On list_trial1_public: BEGIN
[0m18:55:21.606649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:21.615421 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:55:21.615650 [debug] [ThreadPool]: Using postgres connection "list_trial1_public"
[0m18:55:21.615804 [debug] [ThreadPool]: On list_trial1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_trial1_public"} */
select
      'trial1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:55:21.617849 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:55:21.618962 [debug] [ThreadPool]: On list_trial1_public: ROLLBACK
[0m18:55:21.619251 [debug] [ThreadPool]: On list_trial1_public: Close
[0m18:55:21.623365 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:21.623556 [debug] [MainThread]: On master: BEGIN
[0m18:55:21.623687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:21.632385 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:55:21.632610 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:21.632740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:21.640733 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:55:21.641876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '102fde49-2c76-49f8-b278-62a09e0332f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ce770820>]}
[0m18:55:21.642144 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:21.642461 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:21.642589 [debug] [MainThread]: On master: BEGIN
[0m18:55:21.643031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:55:21.643183 [debug] [MainThread]: On master: COMMIT
[0m18:55:21.643310 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:21.643426 [debug] [MainThread]: On master: COMMIT
[0m18:55:21.643649 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:55:21.643807 [debug] [MainThread]: On master: Close
[0m18:55:21.644314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:21.644599 [info ] [MainThread]: 
[0m18:55:21.647014 [debug] [Thread-1 (]: Began running node seed.sample_1.tmdb_5000_credits
[0m18:55:21.647357 [info ] [Thread-1 (]: 1 of 1 START seed file public.tmdb_5000_credits ................................ [RUN]
[0m18:55:21.647902 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:55:21.648046 [debug] [Thread-1 (]: Began compiling node seed.sample_1.tmdb_5000_credits
[0m18:55:21.648211 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:21.648353 [debug] [Thread-1 (]: Began executing node seed.sample_1.tmdb_5000_credits
[0m18:55:22.127204 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:55:22.127434 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: BEGIN
[0m18:55:22.127575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:22.136477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:55:22.136682 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:55:22.136823 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "seed.sample_1.tmdb_5000_credits"} */
truncate table "trial1"."public"."tmdb_5000_credits"
[0m18:55:22.165414 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.03 seconds
[0m18:55:26.766149 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:55:26.766390 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: 
          insert into "trial1"."public"."tmdb_5000_credits" ("movie_id", "title", "cast", "crew") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,...
[0m18:55:27.610540 [debug] [Thread-1 (]: SQL status: INSERT 0 4803 in 0.84 seconds
[0m18:55:27.617993 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sample_1.tmdb_5000_credits"
[0m18:55:27.631408 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:55:27.631584 [debug] [Thread-1 (]: Using postgres connection "seed.sample_1.tmdb_5000_credits"
[0m18:55:27.631707 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: COMMIT
[0m18:55:27.747634 [debug] [Thread-1 (]: SQL status: COMMIT in 0.12 seconds
[0m18:55:27.748455 [debug] [Thread-1 (]: finished collecting timing info
[0m18:55:27.748699 [debug] [Thread-1 (]: On seed.sample_1.tmdb_5000_credits: Close
[0m18:55:27.750934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '102fde49-2c76-49f8-b278-62a09e0332f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ce30bcd0>]}
[0m18:55:27.751302 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.tmdb_5000_credits ............................ [[32mINSERT 4803[0m in 6.10s]
[0m18:55:27.751757 [debug] [Thread-1 (]: Finished running node seed.sample_1.tmdb_5000_credits
[0m18:55:27.752888 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:55:27.753079 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.753206 [debug] [MainThread]: On master: BEGIN
[0m18:55:27.753337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:27.761706 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:55:27.761942 [debug] [MainThread]: On master: COMMIT
[0m18:55:27.762070 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.762193 [debug] [MainThread]: On master: COMMIT
[0m18:55:27.762402 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:55:27.762548 [debug] [MainThread]: On master: Close
[0m18:55:27.763164 [info ] [MainThread]: 
[0m18:55:27.763439 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m18:55:27.763741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:27.763882 [debug] [MainThread]: Connection 'seed.sample_1.tmdb_5000_credits' was properly closed.
[0m18:55:27.785077 [info ] [MainThread]: 
[0m18:55:27.785805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:27.786068 [info ] [MainThread]: 
[0m18:55:27.786266 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:55:27.786555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ce30b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ce770d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ce3787f0>]}
[0m18:55:27.786788 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:56:02.210990 | bb1c473c-84e2-45ca-846c-838293412877 ==============================
[0m18:56:02.211004 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:56:02.211364 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:56:02.211525 [debug] [MainThread]: Tracking: tracking
[0m18:56:02.212625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98a0e8040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98a0e8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98a0e8df0>]}
[0m18:56:02.252293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:56:02.252520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:56:02.257995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb1c473c-84e2-45ca-846c-838293412877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9891a00d0>]}
[0m18:56:02.264075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb1c473c-84e2-45ca-846c-838293412877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe989169060>]}
[0m18:56:02.264393 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:56:02.264622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb1c473c-84e2-45ca-846c-838293412877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98c1f3820>]}
[0m18:56:02.265631 [info ] [MainThread]: 
[0m18:56:02.266158 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:56:02.266886 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial1"
[0m18:56:02.312811 [debug] [ThreadPool]: Using postgres connection "list_trial1"
[0m18:56:02.313064 [debug] [ThreadPool]: On list_trial1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_trial1"} */

    select distinct nspname from pg_namespace
  
[0m18:56:02.313249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:02.323708 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m18:56:02.324960 [debug] [ThreadPool]: On list_trial1: Close
[0m18:56:02.326524 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial1_public"
[0m18:56:02.331921 [debug] [ThreadPool]: Using postgres connection "list_trial1_public"
[0m18:56:02.332092 [debug] [ThreadPool]: On list_trial1_public: BEGIN
[0m18:56:02.332230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:56:02.341082 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:56:02.341304 [debug] [ThreadPool]: Using postgres connection "list_trial1_public"
[0m18:56:02.341453 [debug] [ThreadPool]: On list_trial1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_trial1_public"} */
select
      'trial1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:56:02.343426 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:56:02.344560 [debug] [ThreadPool]: On list_trial1_public: ROLLBACK
[0m18:56:02.344864 [debug] [ThreadPool]: On list_trial1_public: Close
[0m18:56:02.349328 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:02.349524 [debug] [MainThread]: On master: BEGIN
[0m18:56:02.349669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:56:02.358767 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:56:02.358976 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:02.359116 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:56:02.367713 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:56:02.368911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb1c473c-84e2-45ca-846c-838293412877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe989168820>]}
[0m18:56:02.369208 [debug] [MainThread]: On master: ROLLBACK
[0m18:56:02.369543 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:02.369676 [debug] [MainThread]: On master: BEGIN
[0m18:56:02.370051 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:56:02.370201 [debug] [MainThread]: On master: COMMIT
[0m18:56:02.370325 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:02.370441 [debug] [MainThread]: On master: COMMIT
[0m18:56:02.370662 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:56:02.370817 [debug] [MainThread]: On master: Close
[0m18:56:02.371386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:56:02.371681 [info ] [MainThread]: 
[0m18:56:02.374323 [debug] [Thread-1 (]: Began running node model.sample_1.tmdb_credits
[0m18:56:02.374648 [info ] [Thread-1 (]: 1 of 1 START sql table model public.tmdb_credits ............................... [RUN]
[0m18:56:02.375163 [debug] [Thread-1 (]: Acquiring new postgres connection "model.sample_1.tmdb_credits"
[0m18:56:02.375298 [debug] [Thread-1 (]: Began compiling node model.sample_1.tmdb_credits
[0m18:56:02.375442 [debug] [Thread-1 (]: Compiling model.sample_1.tmdb_credits
[0m18:56:02.378134 [debug] [Thread-1 (]: Writing injected SQL for node "model.sample_1.tmdb_credits"
[0m18:56:02.378427 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:02.378593 [debug] [Thread-1 (]: Began executing node model.sample_1.tmdb_credits
[0m18:56:02.416936 [debug] [Thread-1 (]: Writing runtime sql for node "model.sample_1.tmdb_credits"
[0m18:56:02.417476 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:56:02.417650 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: BEGIN
[0m18:56:02.417776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:02.426836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:56:02.427054 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:56:02.427199 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */

  
    

  create  table "trial1"."public"."tmdb_credits__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/




select movie_id, title
from "trial1"."public"."tmdb_5000_credits"

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:56:02.494008 [debug] [Thread-1 (]: SQL status: SELECT 4803 in 0.07 seconds
[0m18:56:02.500325 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:56:02.500507 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
alter table "trial1"."public"."tmdb_credits" rename to "tmdb_credits__dbt_backup"
[0m18:56:02.501021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:56:02.503191 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:56:02.503324 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
alter table "trial1"."public"."tmdb_credits__dbt_tmp" rename to "tmdb_credits"
[0m18:56:02.503718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:56:02.521998 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: COMMIT
[0m18:56:02.522186 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:56:02.522345 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: COMMIT
[0m18:56:02.573447 [debug] [Thread-1 (]: SQL status: COMMIT in 0.05 seconds
[0m18:56:02.579161 [debug] [Thread-1 (]: Using postgres connection "model.sample_1.tmdb_credits"
[0m18:56:02.579387 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "model.sample_1.tmdb_credits"} */
drop table if exists "trial1"."public"."tmdb_credits__dbt_backup" cascade
[0m18:56:02.630595 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m18:56:02.633664 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:02.633928 [debug] [Thread-1 (]: On model.sample_1.tmdb_credits: Close
[0m18:56:02.634708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1c473c-84e2-45ca-846c-838293412877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe988d26d40>]}
[0m18:56:02.635159 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.tmdb_credits .......................... [[32mSELECT 4803[0m in 0.26s]
[0m18:56:02.635692 [debug] [Thread-1 (]: Finished running node model.sample_1.tmdb_credits
[0m18:56:02.637040 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:56:02.637304 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:02.637485 [debug] [MainThread]: On master: BEGIN
[0m18:56:02.637651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:56:02.649787 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:56:02.650152 [debug] [MainThread]: On master: COMMIT
[0m18:56:02.650345 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:02.650517 [debug] [MainThread]: On master: COMMIT
[0m18:56:02.650817 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:56:02.651006 [debug] [MainThread]: On master: Close
[0m18:56:02.651723 [info ] [MainThread]: 
[0m18:56:02.652066 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m18:56:02.652390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:02.652558 [debug] [MainThread]: Connection 'model.sample_1.tmdb_credits' was properly closed.
[0m18:56:02.660073 [info ] [MainThread]: 
[0m18:56:02.660868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:56:02.661130 [info ] [MainThread]: 
[0m18:56:02.661346 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:56:02.661643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe988d4c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe988d17250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9891e8af0>]}
[0m18:56:02.661866 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 18:56:10.909603 | a4611069-c875-4b6f-837c-eb5d73b45d72 ==============================
[0m18:56:10.909613 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:56:10.910016 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m18:56:10.910195 [debug] [MainThread]: Tracking: tracking
[0m18:56:10.911312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0ccc040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0ccce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0cccdf0>]}
[0m18:56:10.954715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:56:10.954963 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:56:10.960344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4611069-c875-4b6f-837c-eb5d73b45d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f03840d0>]}
[0m18:56:10.966513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4611069-c875-4b6f-837c-eb5d73b45d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0351060>]}
[0m18:56:10.966801 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m18:56:10.967050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4611069-c875-4b6f-837c-eb5d73b45d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f2da7190>]}
[0m18:56:10.968155 [info ] [MainThread]: 
[0m18:56:10.968701 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:56:10.969643 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial1_public"
[0m18:56:11.024028 [debug] [ThreadPool]: Using postgres connection "list_trial1_public"
[0m18:56:11.024282 [debug] [ThreadPool]: On list_trial1_public: BEGIN
[0m18:56:11.024461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:11.034439 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m18:56:11.034651 [debug] [ThreadPool]: Using postgres connection "list_trial1_public"
[0m18:56:11.034798 [debug] [ThreadPool]: On list_trial1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_trial1_public"} */
select
      'trial1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:56:11.036731 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:56:11.038040 [debug] [ThreadPool]: On list_trial1_public: ROLLBACK
[0m18:56:11.038357 [debug] [ThreadPool]: On list_trial1_public: Close
[0m18:56:11.042821 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:11.043004 [debug] [MainThread]: On master: BEGIN
[0m18:56:11.043145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:56:11.051851 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:56:11.052050 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:11.052193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:56:11.060672 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m18:56:11.061849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4611069-c875-4b6f-837c-eb5d73b45d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0350f40>]}
[0m18:56:11.062131 [debug] [MainThread]: On master: ROLLBACK
[0m18:56:11.062399 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:11.062519 [debug] [MainThread]: On master: BEGIN
[0m18:56:11.062886 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:56:11.063008 [debug] [MainThread]: On master: COMMIT
[0m18:56:11.063137 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:11.063260 [debug] [MainThread]: On master: COMMIT
[0m18:56:11.063489 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:56:11.063624 [debug] [MainThread]: On master: Close
[0m18:56:11.064320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:56:11.064563 [info ] [MainThread]: 
[0m18:56:11.066954 [debug] [Thread-1 (]: Began running node test.sample_1.check_for_credits_data
[0m18:56:11.067120 [info ] [Thread-1 (]: 1 of 4 START test check_for_credits_data ....................................... [RUN]
[0m18:56:11.067604 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.check_for_credits_data"
[0m18:56:11.067740 [debug] [Thread-1 (]: Began compiling node test.sample_1.check_for_credits_data
[0m18:56:11.067866 [debug] [Thread-1 (]: Compiling test.sample_1.check_for_credits_data
[0m18:56:11.070229 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.check_for_credits_data"
[0m18:56:11.070572 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:11.070732 [debug] [Thread-1 (]: Began executing node test.sample_1.check_for_credits_data
[0m18:56:11.085678 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.check_for_credits_data"
[0m18:56:11.086118 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.check_for_credits_data"
[0m18:56:11.086268 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: BEGIN
[0m18:56:11.086392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:11.096255 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:56:11.096676 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.check_for_credits_data"
[0m18:56:11.096983 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.check_for_credits_data"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from "trial1"."public"."tmdb_credits"
      
    ) dbt_internal_test
[0m18:56:11.098458 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:56:11.100940 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:11.101176 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: ROLLBACK
[0m18:56:11.101558 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: Close
[0m18:56:11.102243 [error] [Thread-1 (]: 1 of 4 FAIL 4803 check_for_credits_data ........................................ [[31mFAIL 4803[0m in 0.03s]
[0m18:56:11.102749 [debug] [Thread-1 (]: Finished running node test.sample_1.check_for_credits_data
[0m18:56:11.103019 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:56:11.103213 [info ] [Thread-1 (]: 2 of 4 START test not_null_tmdb_credits_movie_id ............................... [RUN]
[0m18:56:11.103919 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:56:11.104105 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:56:11.104239 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:56:11.113920 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:56:11.114759 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:11.115427 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:56:11.117420 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:56:11.117719 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:56:11.117859 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: BEGIN
[0m18:56:11.117977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:11.127363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:56:11.127812 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m18:56:11.128127 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "trial1"."public"."tmdb_credits"
where movie_id is null



      
    ) dbt_internal_test
[0m18:56:11.129631 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:56:11.131091 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:11.131297 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: ROLLBACK
[0m18:56:11.131602 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: Close
[0m18:56:11.132257 [info ] [Thread-1 (]: 2 of 4 PASS not_null_tmdb_credits_movie_id ..................................... [[32mPASS[0m in 0.03s]
[0m18:56:11.132739 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m18:56:11.132992 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:56:11.133248 [info ] [Thread-1 (]: 3 of 4 START test not_null_tmdb_credits_title .................................. [RUN]
[0m18:56:11.133922 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:56:11.134117 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:56:11.134276 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:56:11.139824 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:56:11.157100 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:11.157464 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:56:11.161005 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:56:11.161908 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:56:11.162089 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: BEGIN
[0m18:56:11.162213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:11.171460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:56:11.171687 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m18:56:11.171861 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from "trial1"."public"."tmdb_credits"
where title is null



      
    ) dbt_internal_test
[0m18:56:11.172974 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:56:11.174342 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:11.174524 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: ROLLBACK
[0m18:56:11.174823 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: Close
[0m18:56:11.175450 [info ] [Thread-1 (]: 3 of 4 PASS not_null_tmdb_credits_title ........................................ [[32mPASS[0m in 0.04s]
[0m18:56:11.175955 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m18:56:11.176163 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:56:11.176441 [info ] [Thread-1 (]: 4 of 4 START test unique_tmdb_credits_movie_id ................................. [RUN]
[0m18:56:11.176975 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:56:11.177132 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:56:11.177266 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:56:11.183151 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:56:11.207630 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:11.208296 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:56:11.210753 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:56:11.211104 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:56:11.211262 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: BEGIN
[0m18:56:11.211387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:11.220266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m18:56:11.220464 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m18:56:11.220621 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    movie_id as unique_field,
    count(*) as n_records

from "trial1"."public"."tmdb_credits"
where movie_id is not null
group by movie_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:56:11.223432 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:56:11.224724 [debug] [Thread-1 (]: finished collecting timing info
[0m18:56:11.224895 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: ROLLBACK
[0m18:56:11.225140 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: Close
[0m18:56:11.225745 [info ] [Thread-1 (]: 4 of 4 PASS unique_tmdb_credits_movie_id ....................................... [[32mPASS[0m in 0.05s]
[0m18:56:11.226191 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m18:56:11.227368 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:56:11.227545 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:11.227668 [debug] [MainThread]: On master: BEGIN
[0m18:56:11.227775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:56:11.236483 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m18:56:11.236717 [debug] [MainThread]: On master: COMMIT
[0m18:56:11.236917 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:11.237109 [debug] [MainThread]: On master: COMMIT
[0m18:56:11.237429 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:56:11.237644 [debug] [MainThread]: On master: Close
[0m18:56:11.238632 [info ] [MainThread]: 
[0m18:56:11.239072 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m18:56:11.239414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:11.239585 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m18:56:11.250533 [info ] [MainThread]: 
[0m18:56:11.250933 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:56:11.251542 [info ] [MainThread]: 
[0m18:56:11.251812 [error] [MainThread]: [31mFailure in test check_for_credits_data (tests/check_for_credits_data.sql)[0m
[0m18:56:11.252037 [error] [MainThread]:   Got 4803 results, configured to fail if != 0
[0m18:56:11.252247 [info ] [MainThread]: 
[0m18:56:11.252464 [info ] [MainThread]:   compiled Code at target/compiled/sample_1/tests/check_for_credits_data.sql
[0m18:56:11.252727 [info ] [MainThread]: 
[0m18:56:11.252989 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:56:11.253357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0cceb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0ccc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f036b1f0>]}
[0m18:56:11.253707 [debug] [MainThread]: Flushing usage events


============================== 2022-10-28 19:12:58.146361 | 54f278c5-4e85-45a0-a269-19403f539daf ==============================
[0m19:12:58.146371 [info ] [MainThread]: Running with dbt=1.3.0
[0m19:12:58.146731 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/prasil/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:12:58.146905 [debug] [MainThread]: Tracking: tracking
[0m19:12:58.147915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbd4cbb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbd4c8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbd4c8100>]}
[0m19:12:58.189812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:12:58.190290 [debug] [MainThread]: Partial parsing: updated file: sample_1://tests/check_for_credits_data.sql
[0m19:12:58.263779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54f278c5-4e85-45a0-a269-19403f539daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbc5492a0>]}
[0m19:12:58.270221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54f278c5-4e85-45a0-a269-19403f539daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbc526da0>]}
[0m19:12:58.270601 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m19:12:58.270882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54f278c5-4e85-45a0-a269-19403f539daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbf5f7f10>]}
[0m19:12:58.272019 [info ] [MainThread]: 
[0m19:12:58.272630 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:12:58.273585 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial1_public"
[0m19:12:58.284946 [debug] [ThreadPool]: Using postgres connection "list_trial1_public"
[0m19:12:58.285395 [debug] [ThreadPool]: On list_trial1_public: BEGIN
[0m19:12:58.285680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:58.296655 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m19:12:58.297024 [debug] [ThreadPool]: Using postgres connection "list_trial1_public"
[0m19:12:58.297303 [debug] [ThreadPool]: On list_trial1_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "list_trial1_public"} */
select
      'trial1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:12:58.299855 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:12:58.301433 [debug] [ThreadPool]: On list_trial1_public: ROLLBACK
[0m19:12:58.301960 [debug] [ThreadPool]: On list_trial1_public: Close
[0m19:12:58.308250 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:58.308485 [debug] [MainThread]: On master: BEGIN
[0m19:12:58.308664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:12:58.317747 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:12:58.317953 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:58.318097 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:12:58.326570 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m19:12:58.327748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54f278c5-4e85-45a0-a269-19403f539daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbd4cb370>]}
[0m19:12:58.328031 [debug] [MainThread]: On master: ROLLBACK
[0m19:12:58.328316 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:58.328453 [debug] [MainThread]: On master: BEGIN
[0m19:12:58.328890 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:12:58.329028 [debug] [MainThread]: On master: COMMIT
[0m19:12:58.329169 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:58.329305 [debug] [MainThread]: On master: COMMIT
[0m19:12:58.329543 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:12:58.329694 [debug] [MainThread]: On master: Close
[0m19:12:58.330250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:12:58.330554 [info ] [MainThread]: 
[0m19:12:58.333357 [debug] [Thread-1 (]: Began running node test.sample_1.check_for_credits_data
[0m19:12:58.333538 [info ] [Thread-1 (]: 1 of 4 START test check_for_credits_data ....................................... [RUN]
[0m19:12:58.334059 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.check_for_credits_data"
[0m19:12:58.334200 [debug] [Thread-1 (]: Began compiling node test.sample_1.check_for_credits_data
[0m19:12:58.334331 [debug] [Thread-1 (]: Compiling test.sample_1.check_for_credits_data
[0m19:12:58.336709 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.check_for_credits_data"
[0m19:12:58.337078 [debug] [Thread-1 (]: finished collecting timing info
[0m19:12:58.337242 [debug] [Thread-1 (]: Began executing node test.sample_1.check_for_credits_data
[0m19:12:58.353161 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.check_for_credits_data"
[0m19:12:58.353668 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.check_for_credits_data"
[0m19:12:58.353848 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: BEGIN
[0m19:12:58.353991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:58.363975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:12:58.364250 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.check_for_credits_data"
[0m19:12:58.364428 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.check_for_credits_data"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select 1
from "trial1"."public"."tmdb_credits"
      
    ) dbt_internal_test
[0m19:12:58.365437 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:12:58.367584 [debug] [Thread-1 (]: finished collecting timing info
[0m19:12:58.367758 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: ROLLBACK
[0m19:12:58.368052 [debug] [Thread-1 (]: On test.sample_1.check_for_credits_data: Close
[0m19:12:58.368649 [error] [Thread-1 (]: 1 of 4 FAIL 4803 check_for_credits_data ........................................ [[31mFAIL 4803[0m in 0.03s]
[0m19:12:58.369097 [debug] [Thread-1 (]: Finished running node test.sample_1.check_for_credits_data
[0m19:12:58.369309 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m19:12:58.369608 [info ] [Thread-1 (]: 2 of 4 START test not_null_tmdb_credits_movie_id ............................... [RUN]
[0m19:12:58.370197 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m19:12:58.370374 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m19:12:58.370521 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m19:12:58.380383 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m19:12:58.380758 [debug] [Thread-1 (]: finished collecting timing info
[0m19:12:58.380938 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m19:12:58.382918 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m19:12:58.383216 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m19:12:58.383361 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: BEGIN
[0m19:12:58.383489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:58.392862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:12:58.393152 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"
[0m19:12:58.393429 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from "trial1"."public"."tmdb_credits"
where movie_id is null



      
    ) dbt_internal_test
[0m19:12:58.394976 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:12:58.396832 [debug] [Thread-1 (]: finished collecting timing info
[0m19:12:58.397067 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: ROLLBACK
[0m19:12:58.397364 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4: Close
[0m19:12:58.398015 [info ] [Thread-1 (]: 2 of 4 PASS not_null_tmdb_credits_movie_id ..................................... [[32mPASS[0m in 0.03s]
[0m19:12:58.398492 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_movie_id.96b2489ae4
[0m19:12:58.398751 [debug] [Thread-1 (]: Began running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m19:12:58.399051 [info ] [Thread-1 (]: 3 of 4 START test not_null_tmdb_credits_title .................................. [RUN]
[0m19:12:58.399559 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m19:12:58.399709 [debug] [Thread-1 (]: Began compiling node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m19:12:58.399866 [debug] [Thread-1 (]: Compiling test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m19:12:58.403717 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m19:12:58.404120 [debug] [Thread-1 (]: finished collecting timing info
[0m19:12:58.404286 [debug] [Thread-1 (]: Began executing node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m19:12:58.406146 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m19:12:58.406440 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m19:12:58.406579 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: BEGIN
[0m19:12:58.406706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:58.415635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:12:58.415828 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"
[0m19:12:58.415953 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from "trial1"."public"."tmdb_credits"
where title is null



      
    ) dbt_internal_test
[0m19:12:58.417002 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:12:58.418272 [debug] [Thread-1 (]: finished collecting timing info
[0m19:12:58.418438 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: ROLLBACK
[0m19:12:58.418690 [debug] [Thread-1 (]: On test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6: Close
[0m19:12:58.419213 [info ] [Thread-1 (]: 3 of 4 PASS not_null_tmdb_credits_title ........................................ [[32mPASS[0m in 0.02s]
[0m19:12:58.419601 [debug] [Thread-1 (]: Finished running node test.sample_1.not_null_tmdb_credits_title.c7a0ca75c6
[0m19:12:58.419807 [debug] [Thread-1 (]: Began running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m19:12:58.419962 [info ] [Thread-1 (]: 4 of 4 START test unique_tmdb_credits_movie_id ................................. [RUN]
[0m19:12:58.420474 [debug] [Thread-1 (]: Acquiring new postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m19:12:58.420731 [debug] [Thread-1 (]: Began compiling node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m19:12:58.420903 [debug] [Thread-1 (]: Compiling test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m19:12:58.431408 [debug] [Thread-1 (]: Writing injected SQL for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m19:12:58.432799 [debug] [Thread-1 (]: finished collecting timing info
[0m19:12:58.433051 [debug] [Thread-1 (]: Began executing node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m19:12:58.435120 [debug] [Thread-1 (]: Writing runtime sql for node "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m19:12:58.435432 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m19:12:58.435569 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: BEGIN
[0m19:12:58.435688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:58.444467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m19:12:58.444684 [debug] [Thread-1 (]: Using postgres connection "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"
[0m19:12:58.444810 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "sample_1", "target_name": "dev", "node_id": "test.sample_1.unique_tmdb_credits_movie_id.694c09029b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    movie_id as unique_field,
    count(*) as n_records

from "trial1"."public"."tmdb_credits"
where movie_id is not null
group by movie_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:12:58.447244 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:12:58.448451 [debug] [Thread-1 (]: finished collecting timing info
[0m19:12:58.448623 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: ROLLBACK
[0m19:12:58.448866 [debug] [Thread-1 (]: On test.sample_1.unique_tmdb_credits_movie_id.694c09029b: Close
[0m19:12:58.449415 [info ] [Thread-1 (]: 4 of 4 PASS unique_tmdb_credits_movie_id ....................................... [[32mPASS[0m in 0.03s]
[0m19:12:58.449837 [debug] [Thread-1 (]: Finished running node test.sample_1.unique_tmdb_credits_movie_id.694c09029b
[0m19:12:58.451004 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:12:58.451225 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:58.451367 [debug] [MainThread]: On master: BEGIN
[0m19:12:58.451497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:12:58.461016 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m19:12:58.461321 [debug] [MainThread]: On master: COMMIT
[0m19:12:58.461510 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:58.461671 [debug] [MainThread]: On master: COMMIT
[0m19:12:58.461943 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:12:58.462097 [debug] [MainThread]: On master: Close
[0m19:12:58.462776 [info ] [MainThread]: 
[0m19:12:58.463071 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m19:12:58.463355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:58.463489 [debug] [MainThread]: Connection 'test.sample_1.unique_tmdb_credits_movie_id.694c09029b' was properly closed.
[0m19:12:58.492871 [info ] [MainThread]: 
[0m19:12:58.493223 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:12:58.493524 [info ] [MainThread]: 
[0m19:12:58.493740 [error] [MainThread]: [31mFailure in test check_for_credits_data (tests/check_for_credits_data.sql)[0m
[0m19:12:58.493966 [error] [MainThread]:   Got 4803 results, configured to fail if != 0
[0m19:12:58.494177 [info ] [MainThread]: 
[0m19:12:58.494355 [info ] [MainThread]:   compiled Code at target/compiled/sample_1/tests/check_for_credits_data.sql
[0m19:12:58.494561 [info ] [MainThread]: 
[0m19:12:58.494808 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:12:58.495121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbd4cad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbd4cb760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbc194130>]}
[0m19:12:58.495351 [debug] [MainThread]: Flushing usage events
